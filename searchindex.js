Search.setIndex({"docnames": ["api", "api/paste3.glmpca.est_nb_theta", "api/paste3.glmpca.glmpca", "api/paste3.glmpca.glmpca_init", "api/paste3.glmpca.mat_binom_dev", "api/paste3.glmpca.ortho", "api/paste3.helper.match_spots_using_spatial_heuristic", "api/paste3.model_selection.edge_inconsistency_score", "api/paste3.model_selection.generate_graph_from_labels", "api/paste3.model_selection.plot_edge_curve", "api/paste3.paste.center_align", "api/paste3.paste.pairwise_align", "api/paste3.visualization.plot_slice", "api/paste3.visualization.stack_slices_center", "api/paste3.visualization.stack_slices_pairwise", "index", "notebooks/paste2_tutorial", "notebooks/paste_tutorial", "tutorial"], "filenames": ["api.rst", "api/paste3.glmpca.est_nb_theta.rst", "api/paste3.glmpca.glmpca.rst", "api/paste3.glmpca.glmpca_init.rst", "api/paste3.glmpca.mat_binom_dev.rst", "api/paste3.glmpca.ortho.rst", "api/paste3.helper.match_spots_using_spatial_heuristic.rst", "api/paste3.model_selection.edge_inconsistency_score.rst", "api/paste3.model_selection.generate_graph_from_labels.rst", "api/paste3.model_selection.plot_edge_curve.rst", "api/paste3.paste.center_align.rst", "api/paste3.paste.pairwise_align.rst", "api/paste3.visualization.plot_slice.rst", "api/paste3.visualization.stack_slices_center.rst", "api/paste3.visualization.stack_slices_pairwise.rst", "index.rst", "notebooks/paste2_tutorial.ipynb", "notebooks/paste_tutorial.ipynb", "tutorial.rst"], "titles": ["API", "paste3.glmpca.est_nb_theta", "paste3.glmpca.glmpca", "paste3.glmpca.glmpca_init", "paste3.glmpca.mat_binom_dev", "paste3.glmpca.ortho", "paste3.helper.match_spots_using_spatial_heuristic", "paste3.model_selection.edge_inconsistency_score", "paste3.model_selection.generate_graph_from_labels", "paste3.model_selection.plot_edge_curve", "paste3.paste.center_align", "paste3.paste.pairwise_align", "paste3.visualization.plot_slice", "paste3.visualization.stack_slices_center", "paste3.visualization.stack_slices_pairwise", "Welcome to PASTE3 documentation!", "Install PASTE2 python package", "Getting Started", "Tutorials"], "terms": {"import": [0, 2, 16, 17], "paste3": [0, 16, 17], "y": [1, 2, 3, 5, 17], "mu": [1, 2], "th": [1, 10], "sourc": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14], "given": [1, 10, 11, 15], "count": [1, 2, 10], "data": [1, 2, 3, 5, 10, 11, 15, 16, 18], "predict": 1, "mean": [1, 7], "0": [1, 2, 5, 7, 10, 11, 13, 14, 16, 17], "neg": [1, 2], "binom": 1, "theta": [1, 11, 13, 14], "us": [1, 2, 6, 10, 11, 15, 17, 18], "newton": 1, "": [1, 2, 10, 11, 12, 16, 17, 18], "method": [1, 2, 10, 15], "updat": [1, 10, 17], "base": [1, 2, 6, 7, 11], "binomi": [1, 2, 4], "likelihood": [1, 2, 3], "note": [1, 2, 17], "thi": [1, 2, 7, 10, 11, 14, 16, 17], "observ": [1, 2], "rather": 1, "than": [1, 17], "expect": 1, "inform": [1, 10, 11, 16], "regular": [1, 10, 11], "let": [1, 16], "u": [1, 2, 5, 17], "log": 1, "we": [1, 2, 11, 16, 17], "prior": 1, "n": [1, 4, 10, 11, 16], "1": [1, 2, 5, 7, 10, 11, 13, 14, 16, 17], "penalti": [1, 2], "equival": [1, 2], "assum": [1, 5, 17], "lognorm": 1, "so": [1, 2, 16], "mode": 1, "i": [1, 2, 3, 4, 5, 7, 10, 11, 13, 14, 15, 16, 17], "geometr": 1, "distr": 1, "dtheta": 1, "du": 1, "e": [1, 2, 5], "d2theta": 1, "du2": 1, "dl": 1, "l": [2, 10, 11, 17], "fam": [2, 3], "poi": [2, 3], "ctl": 2, "none": [2, 3, 5, 10, 11, 12, 16], "init": 2, "nb_theta": [2, 3], "100": [2, 12, 16, 17], "x": [2, 3, 4, 5, 10, 11, 16, 17], "z": [2, 5, 15, 16, 17], "sz": [2, 3], "glm": 2, "pca": [2, 11], "function": [2, 7, 10, 11, 15, 16, 17], "implement": [2, 16], "dimension": [2, 10, 17], "reduct": 2, "high": 2, "The": [2, 7, 10, 11, 16], "basic": 2, "model": [2, 11, 15], "r": [2, 5, 10, 11], "ax": [2, 5, 9, 12, 17], "zg": [2, 5], "vu": [2, 5], "where": [2, 5, 7, 10, 11, 16], "m": [2, 10], "linkinv": 2, "regress": [2, 3], "coeffici": [2, 3, 5], "ar": [2, 4, 7, 10, 11, 16, 17], "A": [2, 3, 5, 6, 7, 10], "g": [2, 5, 7, 10, 11, 16], "latent": 2, "factor": [2, 3, 5], "load": [2, 5], "v": [2, 5, 17], "object": [2, 3, 10, 11, 15], "being": 2, "optim": [2, 6, 10, 11], "devianc": [2, 4], "between": [2, 6, 10, 11, 13, 14, 15, 16, 17], "plu": 2, "an": [2, 10, 11, 13, 16, 17], "l2": [2, 16], "ridg": 2, "random": [2, 10], "initi": [2, 3, 10, 11, 17], "fulli": [2, 15], "reproduc": [2, 10, 16], "result": 2, "one": [2, 7, 11, 14, 15], "should": [2, 16, 18], "set": [2, 10, 11, 16, 17], "seed": [2, 10], "type": [2, 6, 7, 10, 11, 12, 13, 14], "param": 2, "column": [2, 10, 16, 17], "array_lik": 2, "featur": 2, "row": [2, 10, 16, 17], "desir": 2, "number": [2, 7, 10, 11, 17], "dimens": [2, 5], "integ": 2, "string": 2, "describ": [2, 11], "possibl": 2, "valu": [2, 7, 11, 15, 17], "includ": [2, 10, 16, 17], "poisson": 2, "nb": [2, 3], "mult": 2, "approxim": [2, 10], "multinomi": 2, "bern": 2, "bernoulli": 2, "option": [2, 3, 6, 10, 11, 12, 13, 14, 16, 17], "dict": [2, 7, 16], "dictionari": [2, 7], "control": 2, "paramet": [2, 6, 7, 10, 11, 12, 13, 14, 16, 17], "valid": [2, 16], "kei": 2, "maxit": [2, 11, 16], "maximum": [2, 10, 11, 16, 17], "iter": [2, 10, 11, 16, 17], "ep": [2, 11], "float": [2, 7, 10, 11, 12, 13, 14], "rel": 2, "chang": [2, 10], "toler": [2, 11], "converg": [2, 10, 11, 17], "optimizetheta": [2, 11], "distribut": [2, 10, 11], "default": [2, 3, 10, 11, 17], "fix": 2, "provid": [2, 7, 11, 15, 16, 17], "bool": [2, 6, 10, 11, 14], "indic": [2, 7, 16], "overdispers": 2, "penal": 2, "matric": [2, 11], "contain": [2, 10, 11], "estim": 2, "goe": 2, "infin": 2, "alpha": [2, 10, 11, 16], "statsmodel": 2, "packag": [2, 15], "If": [2, 6, 10, 11, 13, 14], "true": [2, 6, 7, 10, 11, 13, 14, 16, 17], "covari": [2, 5], "ani": [2, 10, 12], "all": [2, 10, 15, 17], "same": [2, 4, 7, 10, 11, 15, 17], "eg": 2, "intercept": 2, "remov": [2, 16], "becaus": 2, "forc": 2, "want": [2, 17], "avoid": 2, "collinear": 2, "usual": 2, "need": [2, 16], "numer": 2, "vector": [2, 3, 4], "size": [2, 3, 12, 16], "place": 2, "total": [2, 7, 14], "return": [2, 6, 7, 10, 11, 12, 13, 14, 16, 17], "follow": [2, 10, 11, 16], "element": [2, 16], "arrai": [2, 3, 4, 5, 16, 17], "whose": 2, "match": [2, 6], "It": 2, "analog": 2, "princip": [2, 11], "compon": [2, 10, 11], "each": [2, 7, 10, 11, 13, 14, 15, 16, 17], "differ": [2, 7, 10, 11, 17], "coefx": 2, "specif": [2, 5, 16], "correspond": 2, "first": [2, 6, 11, 16, 17], "which": [2, 16], "coefz": 2, "By": 2, "dev": 2, "length": [2, 4], "took": 2, "gener": [2, 11], "decreas": 2, "over": [2, 10, 11], "time": [2, 10, 11, 16, 17], "fluctuat": 2, "wildli": 2, "often": 2, "instabl": 2, "can": [2, 15, 16, 17], "improv": [2, 17], "increas": [2, 17], "glmpca_famili": [2, 3], "class": 2, "glmpcafamili": 2, "minor": 2, "wrapper": 2, "famili": 2, "fit": 2, "standard": 2, "variou": 2, "intern": [2, 12], "For": [2, 16, 17], "case": [2, 16, 17], "also": [2, 13, 17], "final": 2, "dispers": 2, "exampl": [2, 16, 18], "creat": [2, 3], "simpl": 2, "dataset": [2, 6, 16, 17], "two": [2, 4, 6, 10, 11, 15, 16, 17], "cluster": [2, 7], "visual": [2, 15, 16, 17], "structur": 2, "from": [2, 7, 10, 11, 16, 17], "numpi": [2, 16, 17], "exp": 2, "repeat": 2, "matplotlib": [2, 12, 16, 17], "pyplot": [2, 12, 16, 17], "scatter": [2, 16], "randn": 2, "20": [2, 16, 17], "rang": [2, 16, 17], "10": [2, 10, 16, 17], "clust": 2, "red": 2, "black": 2, "re": [2, 16], "t": [2, 10, 11, 17], "2": [2, 10, 11, 13, 14, 16, 17], "c": [2, 10, 11, 16], "refer": [2, 10], "town": 2, "fw": 2, "hick": 2, "sc": [2, 16, 17], "arye": 2, "mj": 2, "irizarri": 2, "ra": 2, "select": [2, 11, 15], "singl": 2, "cell": [2, 5], "rna": 2, "seq": 2, "biorxiv": [2, 15], "2019": 2, "http": [2, 16, 17], "www": 2, "org": [2, 16, 17], "content": 2, "1101": 2, "574574v1": 2, "analysi": [2, 11, 14, 18], "arxiv": 2, "ab": 2, "1907": 2, "02647": 2, "jxn": [3, 4, 5], "colmean": 3, "colsum": 3, "ignor": [3, 16], "unless": 3, "p": [4, 10, 11], "col": 4, "nxl": 5, "jxl": 5, "onto": [5, 15], "gene": [5, 10, 11, 15, 16, 17], "nxko": 5, "jxko": 5, "jxkf": 5, "nxkf": 5, "imput": 5, "express": [5, 10, 11, 15, 16, 17], "a_spatial_dist": 6, "b_spatial_dist": 6, "use_ot": 6, "spatial": [6, 10, 11, 12, 13, 14, 15, 17], "coordin": [6, 10, 11, 12, 13, 14, 15, 16, 17], "either": 6, "transport": [6, 10, 11], "bipartit": 6, "proxim": 6, "np": [6, 10, 11, 16, 17], "ndarrai": [6, 10, 11, 13, 14], "spot": [6, 7, 10, 11, 12, 15, 16, 17], "distanc": [6, 10, 11, 15, 17], "matrix": [6, 10, 11, 13, 15, 16, 17], "slice": [6, 7, 8, 10, 11, 12, 13, 14, 15], "second": [6, 11], "ot": [6, 17], "fals": [6, 10, 11, 14, 16, 17], "minimum": 6, "weight": [6, 10, 11], "full": [6, 10, 11], "pi": [6, 10, 11, 13, 14, 16, 17], "repres": [6, 7, 10, 11], "point": 6, "label": [7, 16, 17], "comput": [7, 10, 11, 15, 17], "edg": 7, "inconsist": 7, "score": 7, "graph": 7, "calcul": [7, 11, 17], "measur": [7, 10], "how": [7, 18], "respect": [7, 10, 11], "assign": [7, 15], "node": 7, "defin": [7, 11], "ratio": 7, "connect": 7, "exclud": 7, "within": 7, "networkx": 7, "closest": 7, "neighbor": 7, "map": [7, 10, 11, 16, 17], "index": 7, "align": [7, 10, 11, 13, 14, 15], "anoth": [7, 11], "b": [7, 17], "after": [7, 10, 16], "pairwis": [7, 10, 11, 14, 15], "close": 7, "most": 7, "while": [7, 10, 11], "labels_dict": 8, "overlap_fract": [9, 11, 16], "inconsistency_scor": 9, "titl": [9, 16], "initial_slic": [10, 17], "slice_weight": 10, "n_compon": 10, "15": [10, 16, 17], "threshold": 10, "001": 10, "max_it": 10, "exp_dissim_metr": [10, 11], "kl": [10, 11], "norm": [10, 11, 16], "random_se": [10, 17], "pi_init": [10, 11, 17], "spots_weight": 10, "use_gpu": [10, 11, 17], "fast": 10, "pbar": 10, "infer": [10, 13, 17], "center": [10, 13, 15], "consist": [10, 16, 17], "low": [10, 17], "rank": 10, "wh": 10, "collect": 10, "input": [10, 16, 17], "d": [10, 11, 17], "dot": 10, "n_1": 10, "n_t": 10, "mathbb": [10, 11], "_": [10, 11, 16, 17], "cost": [10, 11], "lambda": 10, "t_": 10, "leq": [10, 11], "find": [10, 11, 15, 16], "w": 10, "h": 10, "q": 10, "gamma": [10, 11], "minim": [10, 11], "sum_q": 10, "lambda_q": 10, "f": [10, 11, 16], "left": [10, 11], "sum_": [10, 11], "j": [10, 11], "wh_": 10, "cdot": 10, "_j": [10, 11], "ij": [10, 11], "k": [10, 11, 16], "d_": [10, 11], "ik": [10, 11], "jl": [10, 11], "right": [10, 11], "x_": 10, "transcript": [10, 11], "d_ij": 10, "parallel": 10, "z_": 10, "nonneg": 10, "profil": 10, "balanc": [10, 11], "preserv": [10, 11], "form": [10, 16], "weigh": 10, "anndata": [10, 11, 12, 13, 14, 15], "list": [10, 13, 14, 16], "process": [10, 11], "treat": 10, "equal": 10, "dissimilar": [10, 11], "among": [10, 11], "onli": [10, 11, 16], "int": [10, 11], "nmf": [10, 17], "stop": 10, "when": [10, 11, 15], "loss": 10, "below": [10, 16, 17], "str": [10, 11, 16, 17], "metric": [10, 11], "euclidean": [10, 11], "kullback": [10, 11], "leibler": [10, 11], "diverg": [10, 11], "normal": [10, 11], "plan": [10, 11, 16], "individu": 10, "uniform": [10, 11], "whether": [10, 11, 14], "gpu": [10, 11, 16], "avail": [10, 11, 16, 17], "cpu": [10, 11, 16, 17], "untest": 10, "torch": [10, 16, 17], "librari": 10, "progress": 10, "bar": 10, "tqdm": 10, "deriv": 10, "track": 10, "someth": 10, "ha": [10, 11], "tupl": [10, 11, 13, 14], "center_slic": [10, 13, 17], "represent": [10, 17], "feature_matrix": 10, "coeff_matrix": 10, "a_slic": 11, "b_slice": 11, "exp_dissim_matrix": 11, "a_spots_weight": 11, "b_spots_weight": 11, "numitermax": 11, "200": [11, 17], "1000": [11, 16], "0001": 11, "do_histologi": 11, "pi_": 11, "probabl": 11, "x_i": 11, "tag": 11, "subject": [11, 16], "constraint": 11, "probabilist": 11, "coupl": 11, "mathcal": 11, "mid": 11, "geq": 11, "1_": 11, "1_n": 11, "appli": 11, "textit": 11, "solv": [11, 17], "partial": [11, 14, 15], "problem": [11, 17], "equat": 11, "allow": [11, 16, 17], "unmap": 11, "fraction": 11, "mass": 11, "3": [11, 16, 17], "overlap": [11, 15, 16], "percentag": [11, 15, 16], "ensur": 11, "must": 11, "perform": 11, "precomput": 11, "euc": 11, "gkl": 11, "selection_kl": 11, "approach": 11, "glmpca": [11, 15], "linear": 11, "dure": 11, "1e": 11, "4": [11, 16, 17], "level": 11, "incorpor": 11, "rgb": 11, "histologi": 11, "info": [11, 16, 17], "return_obj": 11, "els": 11, "color": [12, 16, 17], "plot": [12, 16], "scatterplot": 12, "format": 12, "accept": 12, "pre": 12, "exist": 12, "otherwis": 12, "call": [12, 16], "gca": [12, 16, 17], "In": [13, 14, 15, 16, 17], "other": [13, 14, 16], "word": [13, 14], "origin": [13, 16, 17], "center_align": 13, "output": [13, 14, 17], "output_param": [13, 14], "addition": [13, 14], "angl": [13, 14], "rotat": [13, 14], "translat": [13, 14], "instead": 13, "x_translat": [13, 14], "y_translat": [13, 14], "is_parti": [14, 16], "sequenti": 14, "pairwise_align": [14, 16], "consecut": [14, 15, 16], "return_param": 14, "addtion": 14, "boolean": 14, "wip": 15, "combin": 15, "past": [15, 16, 18], "paste2": [15, 18], "leverag": 15, "both": [15, 17], "similar": 15, "integr": 15, "transcriptom": 15, "extens": 15, "3d": [15, 16], "reconstruct": [15, 16], "thei": [15, 17], "do": [15, 17], "space": 15, "particular": [15, 17], "five": 15, "main": 15, "across": 15, "multipl": 15, "pair": [15, 16], "decid": 15, "5": [15, 16, 17], "stack": 15, "sequenc": [15, 16], "them": [15, 17], "project": [15, 17], "2d": [15, 16], "system": [15, 17], "done": [15, 16, 17], "you": [15, 16, 17], "view": 15, "preprint": 15, "api": 15, "miscellan": 15, "tutori": [15, 16], "get": 15, "start": 15, "instal": 15, "python": 15, "read": 15, "coordiant": 15, "accord": 15, "patch": [16, 17], "mpatch": [16, 17], "plt": [16, 17], "scanpi": [16, 17], "seaborn": 16, "sn": 16, "squidpi": 16, "sq": 16, "opt": [16, 17], "hostedtoolcach": [16, 17], "12": [16, 17], "7": [16, 17], "x64": [16, 17], "lib": [16, 17], "python3": [16, 17], "site": [16, 17], "dask": 16, "datafram": [16, 17], "__init__": 16, "py": [16, 17], "31": [16, 17], "futurewarn": 16, "legaci": 16, "deprec": 16, "futur": 16, "version": 16, "configur": 16, "queri": 16, "enabl": 16, "new": 16, "silenc": 16, "warn": 16, "numba": 16, "core": 16, "decor": 16, "246": [16, 17], "runtimewarn": 16, "nopython": 16, "njit": 16, "39": 16, "pypi": [16, 17], "four": 16, "st": 16, "dlpfc": 16, "patient": 16, "crop": 16, "subslic": 16, "see": [16, 17], "figur": [16, 17], "3a": 16, "our": [16, 17], "paper": 16, "store": 16, "slicea_filenam": 16, "test": [16, 17], "151673": 16, "h5ad": 16, "sliceb_filenam": 16, "151674": 16, "slicec_filenam": 16, "151675": 16, "sliced_filenam": 16, "151676": 16, "slicea": 16, "read_h5ad": 16, "sliceb": 16, "slicec": 16, "matrx": [16, 17], "field": 16, "obsm": [16, 17], "lt": [16, 17], "compress": 16, "spars": 16, "dtype": [16, 17], "float32": [16, 17], "5798687": 16, "shape": 16, "2929": 16, "11381": 16, "gt": [16, 17], "5769": 16, "2807": 16, "4068": 16, "9505": 16, "3393": 16, "7583": 16, "4631": 16, "7831": 16, "5571": 16, "11193": 16, "6317": 16, "3291": 16, "6": [16, 17], "ob": [16, 17], "in_tissu": 16, "array_row": 16, "array_col": 16, "imagerow": 16, "imagecol": 16, "sum_umi": 16, "sum_gen": 16, "posit": 16, "replic": 16, "layer_guess_reordered_short": 16, "n_genes_by_count": 16, "log1p_n_genes_by_count": 16, "total_count": 16, "log1p_total_count": 16, "pct_counts_in_top_50_gen": 16, "pct_counts_in_top_100_gen": 16, "pct_counts_in_top_200_gen": 16, "pct_counts_in_top_500_gen": 16, "n_count": [16, 17], "aaacaatctactagca": 16, "43": [16, 17], "126": 16, "327637": 16, "259": 16, "630972": 16, "1667": 16, "1150": 16, "br8100": 16, "l1": 16, "048386": 16, "419381": 16, "22": [16, 17], "975405": 16, "30": [16, 17], "173965": 16, "42": 16, "171566": 16, "61": 16, "007798": 16, "1628": 16, "aaacaccaataactgc": 16, "8": [16, 17], "59": [16, 17], "19": [16, 17], "427": 16, "767792": 16, "183": 16, "078314": 16, "3769": 16, "1960": 16, "wm": 16, "581210": 16, "234830": 16, "25": [16, 17], "975060": 16, "33": [16, 17], "138764": 16, "531175": 16, "697533": 16, "3704": 16, "aaacagctttcagaag": 16, "9": [16, 17], "341": 16, "269139": 16, "152": 16, "700275": 16, "4278": 16, "2264": 16, "l5": 16, "725330": 16, "361475": 16, "23": [16, 17], "796166": 16, "201029": 16, "38": 16, "826554": 16, "54": 16, "698457": 16, "4217": 16, "aaacagggtctatatt": 16, "47": 16, "13": [16, 17], "362": 16, "916304": 16, "164": 16, "941500": 16, "4004": 16, "2178": 16, "l6": 16, "686621": 16, "295299": 16, "24": [16, 17], "600400": 16, "669331": 16, "185814": 16, "55": [16, 17], "344655": 16, "3922": 16, "aaacagtgttcctggg": 16, "73": 16, "503": 16, "780395": 16, "256": 16, "930702": 16, "2376": 16, "1432": 16, "267525": 16, "773594": 16, "26": [16, 17], "136364": 16, "501684": 16, "308081": 16, "60": 16, "774411": 16, "2339": 16, "ttgtttcacatccagg": 16, "58": [16, 17], "422": 16, "862301": 16, "254": [16, 17], "410450": 16, "4324": 16, "2170": 16, "682943": 16, "372168": 16, "941721": 16, "388529": 16, "40": [16, 17], "703053": 16, "57": 16, "770583": 16, "4266": 16, "ttgtttcattagtcta": 16, "433": 16, "393354": 16, "217": 16, "146722": 16, "2761": 16, "1560": 16, "353082": 16, "923710": 16, "439696": 16, "34": [16, 17], "190511": 16, "824701": 16, "608113": 16, "2715": 16, "ttgtttccatacaact": 16, "45": 16, "27": [16, 17], "352": 16, "430255": 16, "208": 16, "415849": 16, "2322": 16, "1343": 16, "203406": 16, "750615": 16, "093885": 16, "37": 16, "941430": 16, "243755": 16, "63": 16, "695090": 16, "2300": 16, "ttgtttgtattacacg": 16, "41": [16, 17], "735391": 16, "250": [16, 17], "720081": 16, "2331": 16, "1420": 16, "259116": 16, "754481": 16, "139425": 16, "32": 16, "947233": 16, "728443": 16, "531961": 16, "2286": 16, "ttgtttgtgtaaattc": 16, "51": 16, "148": 16, "109816": 16, "284": 16, "293439": 16, "6281": 16, "2927": 16, "982075": 16, "745443": 16, "231810": 16, "154434": 16, "242318": 16, "53": 16, "017036": 16, "6184": 16, "var": [16, 17], "gene_id": 16, "feature_typ": 16, "genom": 16, "n_cells_by_count": 16, "mean_count": 16, "log1p_mean_count": 16, "pct_dropout_by_count": 16, "noc2l": 16, "ensg00000188976": 16, "grch38": 16, "690": 16, "223963": 16, "202094": 16, "81": 16, "038747": 16, "815": 16, "704414": 16, "klhl17": 16, "ensg00000187961": 16, "163": 16, "045342": 16, "044344": 16, "95": 16, "520747": 16, "165": 16, "111988": 16, "hes4": 16, "ensg00000188290": 16, "875": 16, "303105": 16, "264750": 16, "75": 16, "954933": 16, "1103": 16, "006695": 16, "isg15": 16, "ensg00000187608": 16, "968": 16, "318494": 16, "276490": 16, "399286": 16, "1159": 16, "056175": 16, "agrn": 16, "ensg00000188157": 16, "1038": 16, "351470": 16, "301193": 16, "71": 16, "475680": 16, "1279": 16, "154615": 16, "mt": 16, "nd4": 16, "ensg00000198886": 16, "3639": 16, "85": 16, "596596": 16, "461260": 16, "000000": [16, 17], "311486": 16, "649113": 16, "nd5": 16, "ensg00000198786": 16, "3593": 16, "799670": 16, "379516": 16, "264084": 16, "35661": 16, "481841": 16, "nd6": 16, "ensg00000198695": 16, "1966": 16, "860126": 16, "620644": 16, "974169": 16, "3130": 16, "049108": 16, "cyb": 16, "ensg00000198727": 16, "49": [16, 17], "170376": 16, "915425": 16, "178931": 16, "094761": 16, "ac007325": 16, "ensg00000278817": 16, "577": 16, "183567": 16, "168533": 16, "84": 16, "143996": 16, "668": 16, "505784": 16, "layer_guess_reord": 16, "layer": [16, 17], "annot": 16, "pl": [16, 17], "spatial_scatt": 16, "frameon": 16, "figsiz": [16, 17], "pleas": 16, "specifi": 16, "library_id": 16, "perman": 16, "adata": 16, "un": [16, 17], "_spatial_util": 16, "976": 16, "userwarn": 16, "No": 16, "colormap": 16, "via": 16, "cmap": 16, "_cax": 16, "give": 16, "partial_pairwise_align": 16, "To": 16, "well": 16, "70": 16, "area": 16, "your": [16, 17, 18], "own": 16, "manual": 16, "determin": 16, "approxiamt": 16, "doe": [16, 17], "have": [16, 17], "veri": 16, "accur": 16, "now": [16, 17], "here": 16, "demo": 16, "run": 16, "reson": 16, "amount": 16, "real": 16, "scenario": 16, "argument": 16, "pi_ab": 16, "21": [16, 17], "nov": [16, 17], "18": [16, 17], "01": [16, 17], "resort": [16, 17], "pi_bc": 16, "03": [16, 17], "11": [16, 17], "pi_cd": 16, "05": [16, 17], "check": [16, 17], "n1": 16, "n2": 16, "print": [16, 17], "2877": 16, "2873": 16, "2701": 16, "There": 16, "checkout": 16, "signatur": 16, "souc": 16, "code": [16, 17], "document": 16, "def": [16, 17], "largest_indic": 16, "ari": 16, "largest": 16, "flat": 16, "flatten": 16, "argpartit": 16, "argsort": 16, "unravel_index": 16, "plot2d_samples_mat": 16, "xt": 16, "top": 16, "weight_alpha": 16, "kwarg": 16, "mx": 16, "max": 16, "item": 16, "idx": 16, "thr": 16, "len": [16, 17], "plot_slice_pairwise_align": 16, "slice1": [16, 17], "slice2": [16, 17], "coordinates1": 16, "coordinates2": 16, "offset": 16, "min": 16, "temp": 16, "zero": 16, "linewidth": 16, "marker": 16, "zip": 16, "cat": 16, "categori": 16, "layer_guess_reordered_color": 16, "strict": 16, "invert_yaxi": [16, 17], "axi": [16, 17], "off": [16, 17], "show": [16, 17], "onc": 16, "adjac": 16, "assig": 16, "partial_stack_slices_pairwis": 16, "14": [16, 17], "new_slic": [16, 17], "stack_slices_pairwis": [16, 17], "layer_to_color_map": 16, "color_palett": 16, "plot_slices_overlap": 16, "astyp": 16, "legend": [16, 17], "handl": [16, 17], "fontsiz": 16, "cortex": 16, "title_fonts": 16, "bbox_to_anchor": 16, "Or": 16, "just": 16, "3c": 16, "16": [16, 17], "bio": 17, "panda": 17, "pd": 17, "helper": 17, "get_common_gen": 17, "match_spots_using_spatial_heurist": 17, "plot_slic": 17, "stack_slices_cent": 17, "data_dir": 17, "name": 17, "slice_nam": 17, "_coor": 17, "csv": 17, "load_slic": 17, "slice_i": 17, "read_csv": 17, "slice_i_coor": 17, "genfromtxt": 17, "delimit": 17, "preprocess": 17, "pp": 17, "filter_gen": 17, "min_count": 17, "filter_cel": 17, "append": 17, "slice3": 17, "slice4": 17, "064": 17, "086": 17, "116": 17, "015": 17, "945": 17, "999": 17, "987": 17, "011": 17, "984": 17, "choos": 17, "howev": 17, "064x6": 17, "2181": 17, "116x7": 17, "2295": 17, "945x6": 17, "3375": 17, "987x7": 17, "2935": 17, "011x7": 17, "2964": 17, "953x24": 17, "847": 17, "541": 17, "98x24": 17, "963": 17, "860": 17, "063x24": 17, "964": 17, "508": 17, "007x25": 17, "045": 17, "626": 17, "957x25": 17, "871": 17, "2515": 17, "gapdh": 17, "2233": 17, "ube2g2": 17, "78": 17, "mapkapk2": 17, "255": 17, "ndufa7": 17, "96": 17, "asna1": 17, "172": 17, "dip2c": 17, "lypla2": 17, "rgp1": 17, "bpgm": 17, "17": 17, "hps6": 17, "7998": 17, "slice_color": 17, "e41a1c": 17, "377eb8": 17, "4daf4a": 17, "984ea3": 17, "fig": 17, "subplot": 17, "spot_siz": 17, "pi12": 17, "pi23": 17, "pi34": 17, "runtim": 17, "06": 17, "384624719619751": 17, "240": 17, "241": 17, "242": 17, "243": 17, "244": 17, "245": 17, "247": 17, "248": 17, "249": 17, "003937": 17, "000000e": 17, "00": 17, "000063": 17, "003874": 17, "000126": 17, "003811": 17, "937008e": 17, "299213e": 17, "251": 17, "035766e": 17, "252": 17, "003748": 17, "000189": 17, "253": 17, "ve": 17, "400": 17, "togeth": 17, "delax": 17, "plotli": 17, "px": 17, "io": 17, "pio": 17, "render": 17, "notebook": [17, 18], "slices_color": 17, "scale": 17, "z_scale": 17, "enumer": 17, "df": 17, "scatter_3d": 17, "color_discrete_sequ": 17, "update_layout": 17, "scene_aspectmod": 17, "ran": 17, "abov": 17, "alter": 17, "copi": 17, "lmbda": 17, "algorithm": 17, "tensor": 17, "doubl": 17, "07": 17, "sklearn": 17, "decomposit": 17, "_nmf": 17, "1759": 17, "convergencewarn": 17, "reach": 17, "center_ot": 17, "865903767431423": 17, "3829621916807069": 17, "24886595911213": 17, "3880932065404366": 17, "005131014859729666": 17, "3915232061917202": 17, "003429999651283655": 17, "3930712361281365": 17, "0015480299364163397": 17, "28": 17, "395250483498415": 17, "0021792473702784143": 17, "3953790526176948": 17, "00012856911927983106": 17, "896727561950684": 17, "again": 17, "without": 17, "intial": 17, "paste_w": 17, "56406116e": 17, "02": 17, "17735608e": 17, "45992053e": 17, "67005408e": 17, "65816920e": 17, "64249334e": 17, "93240013e": 17, "38372966e": 17, "80787149e": 17, "61882753e": 17, "01921081e": 17, "46527714e": 17, "19665832e": 17, "88694801e": 17, "90303240e": 17, "75023311e": 17, "62389887e": 17, "17923350e": 17, "91596165e": 17, "19205072e": 17, "07181455e": 17, "61294426e": 17, "04": 17, "20524981e": 17, "33305738e": 17, "31159630e": 17, "82986839e": 17, "78688007e": 17, "82425693e": 17, "23265860e": 17, "58806995e": 17, "83314337e": 17, "68948804e": 17, "22536788e": 17, "16837119e": 17, "58040466e": 17, "97049918e": 17, "paste_h": 17, "00595555e": 17, "28095211e": 17, "99820106e": 17, "45672185e": 17, "42535682e": 17, "77099853e": 17, "84556880e": 17, "12907521e": 17, "19053463e": 17, "01912357e": 17, "03440813e": 17, "08299135e": 17, "93982105e": 17, "42403630e": 17, "30713051e": 17, "35120019e": 17, "50568645e": 17, "86018512e": 17, "05294205e": 17, "88580791e": 17, "20976581e": 17, "51081658e": 17, "00736543e": 17, "10129713e": 17, "20159500e": 17, "65184151e": 17, "04867309e": 17, "26153742e": 17, "25054026e": 17, "44712742e": 17, "73756503e": 17, "43537812e": 17, "13147999e": 17, "80617759e": 17, "99149863e": 17, "55629904e": 17, "next": 17, "center_color": 17, "orang": 17, "compar": 17, "sinc": 17, "remain": 17, "thu": 17, "cannot": 17, "pot": 17, "write": 17, "backend": 17, "agnost": 17, "pytorch": 17, "etc": 17, "pythonot": 17, "github": 17, "gen_modul": 17, "html": 17, "support": 17, "make": 17, "sure": 17, "One": 17, "wai": 17, "get_backend_list": 17, "numpybackend": 17, "0x7f1fda8f7bf0": 17, "torchbackend": 17, "0x7f1fe5145af0": 17, "access": 17, "automat": 17, "still": 17, "help": 17, "know": 17, "debug": 17, "why": 17, "seem": 17, "cuda": 17, "is_avail": 17, "breast": 17, "small": 17, "mai": 17, "actual": 17, "faster": 17, "larger": 17, "greater": 17, "easi": 17, "35": 17, "3570709228515625": 17, "29": 17, "skip": 17, "previous": 17, "36": 17, "38540251265489": 17, "44": 17, "46": 17, "381581304723351": 17, "76698381737824": 17, "392083257538912": 17, "010501952815560989": 17, "52": 17, "3945581180803914": 17, "0024748605414794955": 17, "3955875667153284": 17, "0010294486349369247": 17, "3956006249691741": 17, "305825384578796e": 17, "16841721534729": 17, "These": 18, "serv": 18}, "objects": {"": [[0, 0, 0, "-", "paste3"]], "paste3.glmpca": [[1, 1, 1, "", "est_nb_theta"], [2, 1, 1, "", "glmpca"], [3, 1, 1, "", "glmpca_init"], [4, 1, 1, "", "mat_binom_dev"], [5, 1, 1, "", "ortho"]], "paste3.helper": [[6, 1, 1, "", "match_spots_using_spatial_heuristic"]], "paste3.model_selection": [[7, 1, 1, "", "edge_inconsistency_score"], [8, 1, 1, "", "generate_graph_from_labels"], [9, 1, 1, "", "plot_edge_curve"]], "paste3.paste": [[10, 1, 1, "", "center_align"], [11, 1, 1, "", "pairwise_align"]], "paste3.visualization": [[12, 1, 1, "", "plot_slice"], [13, 1, 1, "", "stack_slices_center"], [14, 1, 1, "", "stack_slices_pairwise"]]}, "objtypes": {"0": "py:module", "1": "py:function"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "function", "Python function"]}, "titleterms": {"api": 0, "past": [0, 10, 11, 17], "align": [0, 16, 17], "visual": [0, 12, 13, 14], "model": 0, "select": 0, "glmpca": [0, 1, 2, 3, 4, 5], "miscellan": 0, "paste3": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], "est_nb_theta": 1, "glmpca_init": 3, "mat_binom_dev": 4, "ortho": 5, "helper": 6, "match_spots_using_spatial_heurist": 6, "model_select": [7, 8, 9], "edge_inconsistency_scor": 7, "generate_graph_from_label": 8, "plot_edge_curv": 9, "center_align": [10, 17], "pairwise_align": [11, 17], "plot_slic": 12, "stack_slices_cent": 13, "stack_slices_pairwis": 14, "welcom": 15, "document": 15, "manuscript": 15, "content": 15, "instal": [16, 17], "paste2": 16, "python": [16, 17], "packag": [16, 17], "read": [16, 17], "spatial": 16, "transcriptom": 16, "slice": [16, 17], "anndata": [16, 17], "object": [16, 17], "comput": 16, "partial": 16, "pairwis": [16, 17], "us": 16, "project": 16, "all": 16, "onto": 16, "same": 16, "coordiant": 16, "system": 16, "accord": 16, "get": 17, "start": 17, "data": 17, "creat": 17, "run": 17, "sequenti": 17, "plot": 17, "center": 17, "gpu": 17, "implement": 17, "tutori": 18}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "nbsphinx": 4, "sphinx.ext.viewcode": 1, "sphinx": 57}, "alltitles": {"API": [[0, "api"]], "PASTE Alignment": [[0, "paste-alignment"]], "Visualization": [[0, "visualization"]], "Model Selection": [[0, "model-selection"]], "GLMPCA": [[0, "glmpca"]], "Miscellaneous": [[0, "miscellaneous"]], "paste3.glmpca.est_nb_theta": [[1, "paste3-glmpca-est-nb-theta"]], "paste3.glmpca.glmpca": [[2, "paste3-glmpca-glmpca"]], "paste3.glmpca.glmpca_init": [[3, "paste3-glmpca-glmpca-init"]], "paste3.glmpca.mat_binom_dev": [[4, "paste3-glmpca-mat-binom-dev"]], "paste3.glmpca.ortho": [[5, "paste3-glmpca-ortho"]], "paste3.helper.match_spots_using_spatial_heuristic": [[6, "paste3-helper-match-spots-using-spatial-heuristic"]], "paste3.model_selection.edge_inconsistency_score": [[7, "paste3-model-selection-edge-inconsistency-score"]], "paste3.model_selection.generate_graph_from_labels": [[8, "paste3-model-selection-generate-graph-from-labels"]], "paste3.model_selection.plot_edge_curve": [[9, "paste3-model-selection-plot-edge-curve"]], "paste3.paste.center_align": [[10, "paste3-paste-center-align"]], "paste3.paste.pairwise_align": [[11, "paste3-paste-pairwise-align"]], "paste3.visualization.plot_slice": [[12, "paste3-visualization-plot-slice"]], "paste3.visualization.stack_slices_center": [[13, "paste3-visualization-stack-slices-center"]], "paste3.visualization.stack_slices_pairwise": [[14, "paste3-visualization-stack-slices-pairwise"]], "Welcome to PASTE3 documentation!": [[15, "welcome-to-paste3-documentation"]], "Manuscript": [[15, "manuscript"]], "Contents:": [[15, null]], "Install PASTE2 python package": [[16, "Install-PASTE2-python-package"]], "Read in Spatial Transcriptomics slices as AnnData objects": [[16, "Read-in-Spatial-Transcriptomics-slices-as-AnnData-objects"]], "Compute partial pairwise alignment using PASTE2": [[16, "Compute-partial-pairwise-alignment-using-PASTE2"]], "Project all slices onto the same coordiante system according to the alignment": [[16, "Project-all-slices-onto-the-same-coordiante-system-according-to-the-alignment"]], "Getting Started": [[17, "Getting-Started"]], "Install paste python package": [[17, "Install-paste-python-package"]], "Read data and create AnnData object": [[17, "Read-data-and-create-AnnData-object"]], "Pairwise Alignment": [[17, "Pairwise-Alignment"]], "Run PASTE pairwise_align.": [[17, "Run-PASTE-pairwise_align."]], "Sequential pairwise slice alignment plots": [[17, "Sequential-pairwise-slice-alignment-plots"]], "Center Alignment": [[17, "Center-Alignment"]], "Run PASTE center_align.": [[17, "Run-PASTE-center_align."]], "Center slice alignment plots": [[17, "Center-slice-alignment-plots"]], "Gpu Implementation": [[17, "Gpu-Implementation"]], "Running PASTE with gpu": [[17, "Running-PASTE-with-gpu"]], "Tutorials": [[18, "tutorials"]]}, "indexentries": {"module": [[0, "module-paste3"]], "paste3": [[0, "module-paste3"]], "est_nb_theta() (in module paste3.glmpca)": [[1, "paste3.glmpca.est_nb_theta"]], "glmpca() (in module paste3.glmpca)": [[2, "paste3.glmpca.glmpca"]], "glmpca_init() (in module paste3.glmpca)": [[3, "paste3.glmpca.glmpca_init"]], "mat_binom_dev() (in module paste3.glmpca)": [[4, "paste3.glmpca.mat_binom_dev"]], "ortho() (in module paste3.glmpca)": [[5, "paste3.glmpca.ortho"]], "match_spots_using_spatial_heuristic() (in module paste3.helper)": [[6, "paste3.helper.match_spots_using_spatial_heuristic"]], "edge_inconsistency_score() (in module paste3.model_selection)": [[7, "paste3.model_selection.edge_inconsistency_score"]], "generate_graph_from_labels() (in module paste3.model_selection)": [[8, "paste3.model_selection.generate_graph_from_labels"]], "plot_edge_curve() (in module paste3.model_selection)": [[9, "paste3.model_selection.plot_edge_curve"]], "center_align() (in module paste3.paste)": [[10, "paste3.paste.center_align"]], "pairwise_align() (in module paste3.paste)": [[11, "paste3.paste.pairwise_align"]], "plot_slice() (in module paste3.visualization)": [[12, "paste3.visualization.plot_slice"]], "stack_slices_center() (in module paste3.visualization)": [[13, "paste3.visualization.stack_slices_center"]], "stack_slices_pairwise() (in module paste3.visualization)": [[14, "paste3.visualization.stack_slices_pairwise"]]}})