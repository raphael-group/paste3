Search.setIndex({"docnames": ["api", "api/paste3.glmpca.est_nb_theta", "api/paste3.glmpca.glmpca", "api/paste3.glmpca.glmpca_init", "api/paste3.glmpca.mat_binom_dev", "api/paste3.glmpca.ortho", "api/paste3.helper.match_spots_using_spatial_heuristic", "api/paste3.model_selection.plot_edge_curve", "api/paste3.paste.center_align", "api/paste3.paste.pairwise_align", "api/paste3.visualization.plot_slice", "api/paste3.visualization.stack_slices_center", "api/paste3.visualization.stack_slices_pairwise", "index", "notebooks/paste2_tutorial", "notebooks/paste_tutorial", "tutorial"], "filenames": ["api.rst", "api/paste3.glmpca.est_nb_theta.rst", "api/paste3.glmpca.glmpca.rst", "api/paste3.glmpca.glmpca_init.rst", "api/paste3.glmpca.mat_binom_dev.rst", "api/paste3.glmpca.ortho.rst", "api/paste3.helper.match_spots_using_spatial_heuristic.rst", "api/paste3.model_selection.plot_edge_curve.rst", "api/paste3.paste.center_align.rst", "api/paste3.paste.pairwise_align.rst", "api/paste3.visualization.plot_slice.rst", "api/paste3.visualization.stack_slices_center.rst", "api/paste3.visualization.stack_slices_pairwise.rst", "index.rst", "notebooks/paste2_tutorial.ipynb", "notebooks/paste_tutorial.ipynb", "tutorial.rst"], "titles": ["API", "paste3.glmpca.est_nb_theta", "paste3.glmpca.glmpca", "paste3.glmpca.glmpca_init", "paste3.glmpca.mat_binom_dev", "paste3.glmpca.ortho", "paste3.helper.match_spots_using_spatial_heuristic", "paste3.model_selection.plot_edge_curve", "paste3.paste.center_align", "paste3.paste.pairwise_align", "paste3.visualization.plot_slice", "paste3.visualization.stack_slices_center", "paste3.visualization.stack_slices_pairwise", "Welcome to PASTE3 documentation!", "Install PASTE2 python package", "Getting Started", "Tutorials"], "terms": {"import": [0, 2, 14, 15], "paste3": [0, 14, 15], "y": [1, 2, 3, 5, 15], "mu": [1, 2], "th": [1, 8], "sourc": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12], "given": [1, 7, 8, 9, 13], "count": [1, 2, 8], "data": [1, 2, 3, 5, 8, 9, 13, 14, 16], "predict": 1, "mean": 1, "0": [1, 2, 5, 8, 9, 11, 12, 14, 15], "neg": [1, 2], "binom": 1, "theta": [1, 9, 11, 12], "us": [1, 2, 6, 8, 9, 13, 15, 16], "newton": 1, "": [1, 2, 8, 9, 10, 14, 15, 16], "method": [1, 2, 8, 13], "updat": [1, 8, 15], "base": [1, 2, 6, 9], "binomi": [1, 2, 4], "likelihood": [1, 2, 3], "note": [1, 2, 15], "thi": [1, 2, 8, 9, 12, 14, 15], "observ": [1, 2], "rather": 1, "than": [1, 15], "expect": 1, "inform": [1, 8, 9, 14], "regular": [1, 8, 9], "let": [1, 14], "u": [1, 2, 5, 15], "log": 1, "we": [1, 2, 9, 14, 15], "prior": 1, "n": [1, 4, 8, 9, 14], "1": [1, 2, 5, 8, 9, 11, 12, 14, 15], "penalti": [1, 2], "equival": [1, 2], "assum": [1, 5, 15], "lognorm": 1, "so": [1, 2, 14], "mode": 1, "i": [1, 2, 3, 4, 5, 8, 9, 11, 12, 13, 14, 15], "geometr": 1, "distr": 1, "dtheta": 1, "du": 1, "e": [1, 2, 5], "d2theta": 1, "du2": 1, "dl": 1, "l": [2, 8, 9, 15], "fam": [2, 3], "poi": [2, 3], "ctl": 2, "none": [2, 3, 5, 8, 9, 10, 14], "init": 2, "nb_theta": [2, 3], "100": [2, 10, 14, 15], "x": [2, 3, 4, 5, 8, 9, 14, 15], "z": [2, 5, 13, 14, 15], "sz": [2, 3], "glm": 2, "pca": [2, 9], "function": [2, 8, 9, 13, 14, 15], "implement": [2, 14], "dimension": [2, 8, 15], "reduct": 2, "high": 2, "The": [2, 8, 9, 14], "basic": 2, "model": [2, 9, 13], "r": [2, 5, 8, 9], "ax": [2, 5, 7, 10, 15], "zg": [2, 5], "vu": [2, 5], "where": [2, 5, 8, 9, 14], "m": [2, 8], "linkinv": 2, "regress": [2, 3], "coeffici": [2, 3, 5], "ar": [2, 4, 8, 9, 14, 15], "A": [2, 3, 5, 6, 8], "g": [2, 5, 8, 9, 14], "latent": 2, "factor": [2, 3, 5], "load": [2, 5], "v": [2, 5, 15], "object": [2, 3, 8, 9, 13], "being": 2, "optim": [2, 6, 8, 9], "devianc": [2, 4], "between": [2, 6, 8, 9, 11, 12, 13, 14, 15], "plu": 2, "an": [2, 8, 9, 11, 14, 15], "l2": [2, 14], "ridg": 2, "random": [2, 8], "initi": [2, 3, 8, 9, 15], "fulli": [2, 13], "reproduc": [2, 8, 14], "result": 2, "one": [2, 9, 12, 13], "should": [2, 14, 16], "set": [2, 8, 9, 14, 15], "seed": [2, 8], "type": [2, 6, 8, 9, 10, 11, 12], "param": 2, "column": [2, 8, 14, 15], "array_lik": 2, "featur": 2, "row": [2, 8, 14, 15], "desir": 2, "number": [2, 8, 9, 15], "dimens": [2, 5], "integ": 2, "string": 2, "describ": [2, 9], "possibl": 2, "valu": [2, 9, 13, 15], "includ": [2, 8, 14, 15], "poisson": 2, "nb": [2, 3], "mult": 2, "approxim": [2, 8], "multinomi": 2, "bern": 2, "bernoulli": 2, "option": [2, 3, 6, 8, 9, 10, 11, 12, 14, 15], "dict": [2, 14], "dictionari": 2, "control": 2, "paramet": [2, 6, 8, 9, 10, 11, 12, 14, 15], "valid": [2, 14], "kei": 2, "maxit": [2, 9, 14], "maximum": [2, 8, 9, 14, 15], "iter": [2, 8, 9, 14, 15], "ep": [2, 9], "float": [2, 8, 9, 10, 11, 12], "rel": 2, "chang": [2, 8], "toler": [2, 9], "converg": [2, 8, 9, 15], "optimizetheta": [2, 9], "distribut": [2, 8, 9], "default": [2, 3, 8, 9, 15], "fix": 2, "provid": [2, 9, 13, 14, 15], "bool": [2, 6, 8, 9, 12], "indic": [2, 14], "overdispers": 2, "penal": 2, "matric": [2, 9], "contain": [2, 8, 9], "estim": 2, "goe": 2, "infin": 2, "alpha": [2, 8, 9, 14], "statsmodel": 2, "packag": [2, 13], "If": [2, 6, 8, 9, 11, 12], "true": [2, 6, 8, 9, 11, 12, 14, 15], "covari": [2, 5], "ani": [2, 8, 10], "all": [2, 8, 13, 15], "same": [2, 4, 8, 9, 13, 15], "eg": 2, "intercept": 2, "remov": [2, 14], "becaus": 2, "forc": 2, "want": [2, 15], "avoid": 2, "collinear": 2, "usual": 2, "need": [2, 14], "numer": 2, "vector": [2, 3, 4], "size": [2, 3, 10, 14], "place": 2, "total": [2, 12], "return": [2, 6, 8, 9, 10, 11, 12, 14, 15], "follow": [2, 8, 9, 14], "element": [2, 14], "arrai": [2, 3, 4, 5, 14, 15], "whose": 2, "match": [2, 6], "It": 2, "analog": 2, "princip": [2, 9], "compon": [2, 8, 9], "each": [2, 8, 9, 11, 12, 13, 14, 15], "differ": [2, 8, 9, 15], "coefx": 2, "specif": [2, 5, 14], "correspond": 2, "first": [2, 6, 9, 14, 15], "which": [2, 14], "coefz": 2, "By": 2, "dev": 2, "length": [2, 4], "took": 2, "gener": [2, 9], "decreas": 2, "over": [2, 8, 9], "time": [2, 8, 9, 14, 15], "fluctuat": 2, "wildli": 2, "often": 2, "instabl": 2, "can": [2, 13, 14, 15], "improv": [2, 15], "increas": [2, 15], "glmpca_famili": [2, 3], "class": 2, "glmpcafamili": 2, "minor": 2, "wrapper": 2, "famili": 2, "fit": 2, "standard": 2, "variou": 2, "intern": [2, 10], "For": [2, 14, 15], "case": [2, 14, 15], "also": [2, 11, 15], "final": 2, "dispers": 2, "exampl": [2, 14, 16], "creat": [2, 3], "simpl": 2, "dataset": [2, 6, 14, 15], "two": [2, 4, 6, 8, 9, 13, 14, 15], "cluster": 2, "visual": [2, 13, 14, 15], "structur": 2, "from": [2, 8, 9, 14, 15], "numpi": [2, 14, 15], "exp": 2, "repeat": 2, "matplotlib": [2, 10, 14, 15], "pyplot": [2, 10, 14, 15], "scatter": [2, 14], "randn": 2, "20": [2, 14, 15], "rang": [2, 14, 15], "10": [2, 8, 14, 15], "clust": 2, "red": 2, "black": 2, "re": [2, 14], "t": [2, 8, 9, 15], "2": [2, 8, 9, 11, 12, 14, 15], "c": [2, 8, 9, 14], "refer": [2, 8], "town": 2, "fw": 2, "hick": 2, "sc": [2, 14, 15], "arye": 2, "mj": 2, "irizarri": 2, "ra": 2, "select": [2, 9, 13], "singl": 2, "cell": [2, 5], "rna": 2, "seq": 2, "biorxiv": [2, 13], "2019": 2, "http": [2, 14, 15], "www": 2, "org": [2, 14, 15], "content": 2, "1101": 2, "574574v1": 2, "analysi": [2, 9, 12, 16], "arxiv": 2, "ab": 2, "1907": 2, "02647": 2, "jxn": [3, 4, 5], "colmean": 3, "colsum": 3, "ignor": [3, 14], "unless": 3, "p": [4, 8, 9], "col": 4, "nxl": 5, "jxl": 5, "onto": [5, 13], "gene": [5, 8, 9, 13, 14, 15], "nxko": 5, "jxko": 5, "jxkf": 5, "nxkf": 5, "imput": 5, "express": [5, 8, 9, 13, 14, 15], "a_spatial_dist": 6, "b_spatial_dist": 6, "use_ot": 6, "spatial": [6, 8, 9, 10, 11, 12, 13, 15], "coordin": [6, 8, 9, 10, 11, 12, 13, 14, 15], "either": 6, "transport": [6, 8, 9], "bipartit": 6, "proxim": 6, "np": [6, 8, 9, 14, 15], "ndarrai": [6, 8, 9, 11, 12], "spot": [6, 8, 9, 10, 13, 14, 15], "distanc": [6, 8, 9, 13, 15], "matrix": [6, 8, 9, 11, 13, 14, 15], "slice": [6, 8, 9, 10, 11, 12, 13], "second": [6, 9], "ot": [6, 15], "fals": [6, 8, 9, 12, 14, 15], "minimum": 6, "weight": [6, 8, 9], "full": [6, 8, 9], "pi": [6, 8, 9, 11, 12, 14, 15], "repres": [6, 8, 9], "point": 6, "overlap_fract": [7, 9, 14], "inconsistency_scor": 7, "titl": [7, 14], "plot": [7, 10, 14], "relat": 7, "overlap": [7, 9, 13, 14], "fraction": [7, 9], "axi": [7, 14, 15], "initial_slic": [8, 15], "slice_weight": 8, "n_compon": 8, "15": [8, 14, 15], "threshold": 8, "001": 8, "max_it": 8, "exp_dissim_metr": [8, 9], "kl": [8, 9], "norm": [8, 9, 14], "random_se": [8, 15], "pi_init": [8, 9, 15], "spots_weight": 8, "use_gpu": [8, 9, 15], "fast": 8, "pbar": 8, "infer": [8, 11, 15], "center": [8, 11, 13], "consist": [8, 14, 15], "low": [8, 15], "rank": 8, "wh": 8, "collect": 8, "map": [8, 9, 14, 15], "input": [8, 14, 15], "d": [8, 9, 15], "dot": 8, "n_1": 8, "n_t": 8, "respect": [8, 9], "mathbb": [8, 9], "_": [8, 9, 14, 15], "cost": [8, 9], "lambda": 8, "t_": 8, "leq": [8, 9], "find": [8, 9, 13, 14], "w": 8, "h": 8, "q": 8, "gamma": [8, 9], "minim": [8, 9], "sum_q": 8, "lambda_q": 8, "f": [8, 9, 14], "left": [8, 9], "sum_": [8, 9], "j": [8, 9], "wh_": 8, "cdot": 8, "_j": [8, 9], "ij": [8, 9], "k": [8, 9, 14], "d_": [8, 9], "ik": [8, 9], "jl": [8, 9], "right": [8, 9], "x_": 8, "transcript": [8, 9], "d_ij": 8, "parallel": 8, "z_": 8, "pairwis": [8, 9, 12, 13], "measur": 8, "nonneg": 8, "profil": 8, "balanc": [8, 9], "preserv": [8, 9], "form": [8, 14], "weigh": 8, "anndata": [8, 9, 10, 11, 12, 13], "align": [8, 9, 11, 12, 13], "list": [8, 11, 12, 14], "process": [8, 9], "treat": 8, "equal": 8, "dissimilar": [8, 9], "among": [8, 9], "onli": [8, 9, 14], "while": [8, 9], "int": [8, 9], "nmf": [8, 15], "stop": 8, "when": [8, 9, 13], "loss": 8, "below": [8, 14, 15], "str": [8, 9, 14, 15], "metric": [8, 9], "comput": [8, 9, 13, 15], "euclidean": [8, 9], "kullback": [8, 9], "leibler": [8, 9], "diverg": [8, 9], "normal": [8, 9], "plan": [8, 9, 14], "individu": 8, "uniform": [8, 9], "whether": [8, 9, 12], "gpu": [8, 9, 14], "avail": [8, 9, 14, 15], "cpu": [8, 9, 14, 15], "untest": 8, "torch": [8, 14, 15], "librari": 8, "progress": 8, "bar": 8, "tqdm": 8, "deriv": 8, "track": 8, "someth": 8, "ha": [8, 9], "tupl": [8, 9, 11, 12], "center_slic": [8, 11, 15], "after": [8, 14], "represent": [8, 15], "feature_matrix": 8, "coeff_matrix": 8, "a_slic": 9, "b_slice": 9, "exp_dissim_matrix": 9, "a_spots_weight": 9, "b_spots_weight": 9, "numitermax": 9, "200": [9, 15], "1000": [9, 14], "0001": 9, "do_histologi": 9, "pi_": 9, "anoth": 9, "probabl": 9, "x_i": 9, "tag": 9, "subject": [9, 14], "constraint": 9, "probabilist": 9, "coupl": 9, "mathcal": 9, "mid": 9, "geq": 9, "1_": 9, "1_n": 9, "appli": 9, "textit": 9, "solv": [9, 15], "partial": [9, 12, 13], "problem": [9, 15], "equat": 9, "allow": [9, 14, 15], "unmap": 9, "mass": 9, "defin": 9, "3": [9, 14, 15], "percentag": [9, 13, 14], "ensur": 9, "must": 9, "perform": 9, "precomput": 9, "euc": 9, "gkl": 9, "selection_kl": 9, "approach": 9, "glmpca": [9, 13], "linear": 9, "calcul": [9, 15], "dure": 9, "1e": 9, "4": [9, 14, 15], "level": 9, "incorpor": 9, "rgb": 9, "histologi": 9, "info": [9, 14, 15], "return_obj": 9, "els": 9, "color": [10, 14, 15], "scatterplot": 10, "format": 10, "accept": 10, "pre": 10, "exist": 10, "otherwis": 10, "call": [10, 14], "gca": [10, 14, 15], "In": [11, 12, 13, 14, 15], "other": [11, 12, 14], "word": [11, 12], "origin": [11, 14, 15], "center_align": 11, "output": [11, 12, 15], "output_param": [11, 12], "addition": [11, 12], "angl": [11, 12], "rotat": [11, 12], "translat": [11, 12], "instead": 11, "x_translat": [11, 12], "y_translat": [11, 12], "is_parti": [12, 14], "sequenti": 12, "pairwise_align": [12, 14], "consecut": [12, 13, 14], "return_param": 12, "addtion": 12, "boolean": 12, "wip": 13, "combin": 13, "past": [13, 14, 16], "paste2": [13, 16], "leverag": 13, "both": [13, 15], "similar": 13, "integr": 13, "transcriptom": 13, "extens": 13, "3d": [13, 14], "reconstruct": [13, 14], "thei": [13, 15], "do": [13, 15], "space": 13, "particular": [13, 15], "five": 13, "main": 13, "across": 13, "multipl": 13, "pair": [13, 14], "decid": 13, "5": [13, 14, 15], "stack": 13, "sequenc": [13, 14], "them": [13, 15], "project": [13, 15], "2d": [13, 14], "system": [13, 15], "done": [13, 14, 15], "assign": 13, "you": [13, 14, 15], "view": 13, "preprint": 13, "api": 13, "miscellan": 13, "tutori": [13, 14], "get": 13, "start": 13, "instal": 13, "python": 13, "read": 13, "coordiant": 13, "accord": 13, "patch": [14, 15], "mpatch": [14, 15], "plt": [14, 15], "scanpi": [14, 15], "seaborn": 14, "sn": 14, "squidpi": 14, "sq": 14, "opt": [14, 15], "hostedtoolcach": [14, 15], "12": [14, 15], "7": [14, 15], "x64": [14, 15], "lib": [14, 15], "python3": [14, 15], "site": [14, 15], "dask": 14, "datafram": [14, 15], "__init__": 14, "py": [14, 15], "31": [14, 15], "futurewarn": 14, "legaci": 14, "deprec": 14, "futur": 14, "version": 14, "configur": 14, "queri": 14, "enabl": 14, "new": 14, "silenc": 14, "warn": 14, "numba": 14, "core": 14, "decor": 14, "246": [14, 15], "runtimewarn": 14, "nopython": 14, "njit": 14, "39": [14, 15], "pypi": [14, 15], "four": 14, "st": 14, "dlpfc": 14, "patient": 14, "crop": 14, "subslic": 14, "see": [14, 15], "figur": [14, 15], "3a": 14, "our": [14, 15], "paper": 14, "store": 14, "slicea_filenam": 14, "test": [14, 15], "151673": 14, "h5ad": 14, "sliceb_filenam": 14, "151674": 14, "slicec_filenam": 14, "151675": 14, "sliced_filenam": 14, "151676": 14, "slicea": 14, "read_h5ad": 14, "sliceb": 14, "slicec": 14, "matrx": [14, 15], "field": 14, "obsm": [14, 15], "lt": [14, 15], "compress": 14, "spars": 14, "dtype": [14, 15], "float32": [14, 15], "5798687": 14, "shape": 14, "2929": 14, "11381": 14, "gt": [14, 15], "5769": 14, "2807": 14, "4068": 14, "9505": 14, "3393": 14, "7583": 14, "4631": 14, "7831": 14, "5571": 14, "11193": 14, "6317": 14, "3291": 14, "6": [14, 15], "ob": [14, 15], "in_tissu": 14, "array_row": 14, "array_col": 14, "imagerow": 14, "imagecol": 14, "sum_umi": 14, "sum_gen": 14, "posit": 14, "replic": 14, "layer_guess_reordered_short": 14, "n_genes_by_count": 14, "log1p_n_genes_by_count": 14, "total_count": 14, "log1p_total_count": 14, "pct_counts_in_top_50_gen": 14, "pct_counts_in_top_100_gen": 14, "pct_counts_in_top_200_gen": 14, "pct_counts_in_top_500_gen": 14, "n_count": [14, 15], "aaacaatctactagca": 14, "43": [14, 15], "126": 14, "327637": 14, "259": 14, "630972": 14, "1667": 14, "1150": 14, "br8100": 14, "l1": 14, "048386": 14, "419381": 14, "22": [14, 15], "975405": 14, "30": [14, 15], "173965": 14, "42": [14, 15], "171566": 14, "61": 14, "007798": 14, "1628": 14, "aaacaccaataactgc": 14, "8": [14, 15], "59": [14, 15], "19": [14, 15], "427": 14, "767792": 14, "183": 14, "078314": 14, "3769": 14, "1960": 14, "wm": 14, "581210": 14, "234830": 14, "25": [14, 15], "975060": 14, "33": [14, 15], "138764": 14, "531175": 14, "697533": 14, "3704": 14, "aaacagctttcagaag": 14, "9": [14, 15], "341": 14, "269139": 14, "152": 14, "700275": 14, "4278": 14, "2264": 14, "l5": 14, "725330": 14, "361475": 14, "23": [14, 15], "796166": 14, "201029": 14, "38": 14, "826554": 14, "54": [14, 15], "698457": 14, "4217": 14, "aaacagggtctatatt": 14, "47": 14, "13": [14, 15], "362": 14, "916304": 14, "164": 14, "941500": 14, "4004": 14, "2178": 14, "l6": 14, "686621": 14, "295299": 14, "24": [14, 15], "600400": 14, "669331": 14, "185814": 14, "55": 14, "344655": 14, "3922": 14, "aaacagtgttcctggg": 14, "73": 14, "503": 14, "780395": 14, "256": 14, "930702": 14, "2376": 14, "1432": 14, "267525": 14, "773594": 14, "26": [14, 15], "136364": 14, "501684": 14, "308081": 14, "60": 14, "774411": 14, "2339": 14, "ttgtttcacatccagg": 14, "58": 14, "422": 14, "862301": 14, "254": [14, 15], "410450": 14, "4324": 14, "2170": 14, "682943": 14, "372168": 14, "941721": 14, "388529": 14, "40": [14, 15], "703053": 14, "57": 14, "770583": 14, "4266": 14, "ttgtttcattagtcta": 14, "433": 14, "393354": 14, "217": 14, "146722": 14, "2761": 14, "1560": 14, "353082": 14, "923710": 14, "439696": 14, "34": 14, "190511": 14, "824701": 14, "608113": 14, "2715": 14, "ttgtttccatacaact": 14, "45": [14, 15], "27": [14, 15], "352": 14, "430255": 14, "208": 14, "415849": 14, "2322": 14, "1343": 14, "203406": 14, "750615": 14, "093885": 14, "37": 14, "941430": 14, "243755": 14, "63": 14, "695090": 14, "2300": 14, "ttgtttgtattacacg": 14, "41": 14, "735391": 14, "250": [14, 15], "720081": 14, "2331": 14, "1420": 14, "259116": 14, "754481": 14, "139425": 14, "32": 14, "947233": 14, "728443": 14, "531961": 14, "2286": 14, "ttgtttgtgtaaattc": 14, "51": [14, 15], "148": 14, "109816": 14, "284": 14, "293439": 14, "6281": 14, "2927": 14, "982075": 14, "745443": 14, "231810": 14, "154434": 14, "242318": 14, "53": [14, 15], "017036": 14, "6184": 14, "var": [14, 15], "gene_id": 14, "feature_typ": 14, "genom": 14, "n_cells_by_count": 14, "mean_count": 14, "log1p_mean_count": 14, "pct_dropout_by_count": 14, "noc2l": 14, "ensg00000188976": 14, "grch38": 14, "690": 14, "223963": 14, "202094": 14, "81": 14, "038747": 14, "815": 14, "704414": 14, "klhl17": 14, "ensg00000187961": 14, "163": 14, "045342": 14, "044344": 14, "95": 14, "520747": 14, "165": 14, "111988": 14, "hes4": 14, "ensg00000188290": 14, "875": 14, "303105": 14, "264750": 14, "75": 14, "954933": 14, "1103": 14, "006695": 14, "isg15": 14, "ensg00000187608": 14, "968": 14, "318494": 14, "276490": 14, "399286": 14, "1159": 14, "056175": 14, "agrn": 14, "ensg00000188157": 14, "1038": 14, "351470": 14, "301193": 14, "71": 14, "475680": 14, "1279": 14, "154615": 14, "mt": 14, "nd4": 14, "ensg00000198886": 14, "3639": 14, "85": 14, "596596": 14, "461260": 14, "000000": [14, 15], "311486": 14, "649113": 14, "nd5": 14, "ensg00000198786": 14, "3593": 14, "799670": 14, "379516": 14, "264084": 14, "35661": 14, "481841": 14, "nd6": 14, "ensg00000198695": 14, "1966": 14, "860126": 14, "620644": 14, "974169": 14, "3130": 14, "049108": 14, "cyb": 14, "ensg00000198727": 14, "49": [14, 15], "170376": 14, "915425": 14, "178931": 14, "094761": 14, "ac007325": 14, "ensg00000278817": 14, "577": 14, "183567": 14, "168533": 14, "84": 14, "143996": 14, "668": 14, "505784": 14, "layer_guess_reord": 14, "layer": [14, 15], "annot": 14, "pl": [14, 15], "spatial_scatt": 14, "frameon": 14, "figsiz": [14, 15], "pleas": 14, "specifi": 14, "library_id": 14, "perman": 14, "adata": 14, "un": [14, 15], "_spatial_util": 14, "976": 14, "userwarn": 14, "No": 14, "colormap": 14, "via": 14, "cmap": 14, "_cax": 14, "give": 14, "partial_pairwise_align": 14, "To": 14, "well": 14, "70": 14, "area": 14, "your": [14, 15, 16], "own": 14, "manual": 14, "determin": 14, "approxiamt": 14, "doe": [14, 15], "have": [14, 15], "veri": 14, "accur": 14, "now": [14, 15], "here": 14, "demo": 14, "run": 14, "reson": 14, "amount": 14, "real": 14, "scenario": 14, "argument": 14, "pi_ab": 14, "nov": [14, 15], "16": [14, 15], "resort": [14, 15], "pi_bc": 14, "35": 14, "11": [14, 15], "pi_cd": 14, "check": [14, 15], "n1": 14, "n2": 14, "print": [14, 15], "2877": 14, "2873": 14, "2701": 14, "There": 14, "checkout": 14, "signatur": 14, "souc": 14, "code": [14, 15], "document": 14, "def": [14, 15], "largest_indic": 14, "ari": 14, "largest": 14, "flat": 14, "flatten": 14, "argpartit": 14, "argsort": 14, "unravel_index": 14, "plot2d_samples_mat": 14, "xt": 14, "top": 14, "weight_alpha": 14, "kwarg": 14, "mx": 14, "max": 14, "item": 14, "idx": 14, "thr": 14, "len": [14, 15], "plot_slice_pairwise_align": 14, "slice1": [14, 15], "slice2": [14, 15], "05": [14, 15], "coordinates1": 14, "coordinates2": 14, "offset": 14, "min": 14, "temp": 14, "zero": 14, "linewidth": 14, "marker": 14, "zip": 14, "cat": 14, "categori": 14, "layer_guess_reordered_color": 14, "strict": 14, "invert_yaxi": [14, 15], "off": [14, 15], "show": [14, 15], "onc": 14, "adjac": 14, "assig": 14, "partial_stack_slices_pairwis": 14, "14": [14, 15], "new_slic": [14, 15], "stack_slices_pairwis": [14, 15], "layer_to_color_map": 14, "color_palett": 14, "plot_slices_overlap": 14, "astyp": 14, "legend": [14, 15], "handl": [14, 15], "label": [14, 15], "fontsiz": 14, "cortex": 14, "title_fonts": 14, "bbox_to_anchor": 14, "Or": 14, "just": 14, "3c": 14, "bio": 15, "panda": 15, "pd": 15, "helper": 15, "get_common_gen": 15, "match_spots_using_spatial_heurist": 15, "plot_slic": 15, "stack_slices_cent": 15, "data_dir": 15, "name": 15, "slice_nam": 15, "_coor": 15, "csv": 15, "load_slic": 15, "slice_i": 15, "read_csv": 15, "slice_i_coor": 15, "genfromtxt": 15, "delimit": 15, "preprocess": 15, "pp": 15, "filter_gen": 15, "min_count": 15, "filter_cel": 15, "append": 15, "slice3": 15, "slice4": 15, "064": 15, "086": 15, "116": 15, "015": 15, "945": 15, "999": 15, "987": 15, "011": 15, "984": 15, "choos": 15, "howev": 15, "064x6": 15, "2181": 15, "116x7": 15, "2295": 15, "945x6": 15, "3375": 15, "987x7": 15, "2935": 15, "011x7": 15, "2964": 15, "21": 15, "953x24": 15, "847": 15, "541": 15, "98x24": 15, "963": 15, "860": 15, "063x24": 15, "964": 15, "508": 15, "007x25": 15, "045": 15, "626": 15, "957x25": 15, "871": 15, "2515": 15, "gapdh": 15, "2233": 15, "ube2g2": 15, "78": 15, "mapkapk2": 15, "255": 15, "ndufa7": 15, "96": 15, "asna1": 15, "172": 15, "dip2c": 15, "lypla2": 15, "rgp1": 15, "bpgm": 15, "17": 15, "hps6": 15, "7998": 15, "slice_color": 15, "e41a1c": 15, "377eb8": 15, "4daf4a": 15, "984ea3": 15, "fig": 15, "subplot": 15, "spot_siz": 15, "pi12": 15, "pi23": 15, "pi34": 15, "runtim": 15, "29": 15, "4022023677825928": 15, "240": 15, "241": 15, "242": 15, "243": 15, "244": 15, "245": 15, "247": 15, "248": 15, "249": 15, "003937": 15, "000000e": 15, "00": 15, "000063": 15, "003874": 15, "000126": 15, "003811": 15, "937008e": 15, "03": 15, "299213e": 15, "251": 15, "035766e": 15, "252": 15, "003748": 15, "000189": 15, "253": 15, "ve": 15, "400": 15, "togeth": 15, "delax": 15, "plotli": 15, "px": 15, "io": 15, "pio": 15, "render": 15, "notebook": [15, 16], "slices_color": 15, "scale": 15, "z_scale": 15, "enumer": 15, "df": 15, "scatter_3d": 15, "color_discrete_sequ": 15, "update_layout": 15, "scene_aspectmod": 15, "ran": 15, "abov": 15, "alter": 15, "copi": 15, "lmbda": 15, "algorithm": 15, "b": 15, "tensor": 15, "doubl": 15, "18": 15, "sklearn": 15, "decomposit": 15, "_nmf": 15, "1759": 15, "convergencewarn": 15, "reach": 15, "center_ot": 15, "865903767431423": 15, "36": 15, "3829621916807069": 15, "24886595911213": 15, "3880932065404366": 15, "005131014859729666": 15, "3915232061917202": 15, "003429999651283655": 15, "3930712361281365": 15, "0015480299364163397": 15, "46": 15, "48": 15, "395250483498415": 15, "0021792473702784143": 15, "3953790526176948": 15, "00012856911927983106": 15, "478368282318115": 15, "again": 15, "without": 15, "intial": 15, "paste_w": 15, "56406116e": 15, "02": 15, "17735608e": 15, "45992053e": 15, "01": 15, "67005408e": 15, "65816920e": 15, "64249334e": 15, "93240013e": 15, "38372966e": 15, "80787149e": 15, "61882753e": 15, "01921081e": 15, "46527714e": 15, "19665832e": 15, "88694801e": 15, "90303240e": 15, "75023311e": 15, "62389887e": 15, "17923350e": 15, "91596165e": 15, "19205072e": 15, "07181455e": 15, "61294426e": 15, "04": 15, "20524981e": 15, "33305738e": 15, "31159630e": 15, "82986839e": 15, "78688007e": 15, "82425693e": 15, "23265860e": 15, "58806995e": 15, "83314337e": 15, "68948804e": 15, "22536788e": 15, "16837119e": 15, "58040466e": 15, "97049918e": 15, "paste_h": 15, "00595555e": 15, "28095211e": 15, "99820106e": 15, "45672185e": 15, "42535682e": 15, "77099853e": 15, "84556880e": 15, "12907521e": 15, "19053463e": 15, "01912357e": 15, "03440813e": 15, "08299135e": 15, "93982105e": 15, "42403630e": 15, "30713051e": 15, "35120019e": 15, "50568645e": 15, "86018512e": 15, "05294205e": 15, "88580791e": 15, "20976581e": 15, "51081658e": 15, "00736543e": 15, "06": 15, "10129713e": 15, "20159500e": 15, "65184151e": 15, "04867309e": 15, "26153742e": 15, "25054026e": 15, "44712742e": 15, "73756503e": 15, "43537812e": 15, "13147999e": 15, "80617759e": 15, "99149863e": 15, "55629904e": 15, "next": 15, "center_color": 15, "orang": 15, "compar": 15, "sinc": 15, "remain": 15, "thu": 15, "cannot": 15, "pot": 15, "write": 15, "backend": 15, "agnost": 15, "pytorch": 15, "etc": 15, "pythonot": 15, "github": 15, "gen_modul": 15, "html": 15, "support": 15, "make": 15, "sure": 15, "One": 15, "wai": 15, "get_backend_list": 15, "numpybackend": 15, "0x7f1edcc51c70": 15, "torchbackend": 15, "0x7f1ee0944c80": 15, "access": 15, "automat": 15, "still": 15, "help": 15, "know": 15, "debug": 15, "why": 15, "seem": 15, "cuda": 15, "is_avail": 15, "breast": 15, "small": 15, "mai": 15, "actual": 15, "faster": 15, "larger": 15, "greater": 15, "easi": 15, "28": 15, "3652501106262207": 15, "skip": 15, "previous": 15, "38540251265489": 15, "381581304723351": 15, "76698381737824": 15, "08": 15, "392083257538912": 15, "010501952815560989": 15, "3945581180803914": 15, "0024748605414794955": 15, "3955875667153284": 15, "0010294486349369247": 15, "3956006249691741": 15, "305825384578796e": 15, "16499924659729": 15, "These": 16, "serv": 16, "how": 16}, "objects": {"": [[0, 0, 0, "-", "paste3"]], "paste3.glmpca": [[1, 1, 1, "", "est_nb_theta"], [2, 1, 1, "", "glmpca"], [3, 1, 1, "", "glmpca_init"], [4, 1, 1, "", "mat_binom_dev"], [5, 1, 1, "", "ortho"]], "paste3.helper": [[6, 1, 1, "", "match_spots_using_spatial_heuristic"]], "paste3.model_selection": [[7, 1, 1, "", "plot_edge_curve"]], "paste3.paste": [[8, 1, 1, "", "center_align"], [9, 1, 1, "", "pairwise_align"]], "paste3.visualization": [[10, 1, 1, "", "plot_slice"], [11, 1, 1, "", "stack_slices_center"], [12, 1, 1, "", "stack_slices_pairwise"]]}, "objtypes": {"0": "py:module", "1": "py:function"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "function", "Python function"]}, "titleterms": {"api": 0, "past": [0, 8, 9, 15], "align": [0, 14, 15], "visual": [0, 10, 11, 12], "model": 0, "select": 0, "glmpca": [0, 1, 2, 3, 4, 5], "miscellan": 0, "paste3": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13], "est_nb_theta": 1, "glmpca_init": 3, "mat_binom_dev": 4, "ortho": 5, "helper": 6, "match_spots_using_spatial_heurist": 6, "model_select": 7, "plot_edge_curv": 7, "center_align": [8, 15], "pairwise_align": [9, 15], "plot_slic": 10, "stack_slices_cent": 11, "stack_slices_pairwis": 12, "welcom": 13, "document": 13, "manuscript": 13, "content": 13, "instal": [14, 15], "paste2": 14, "python": [14, 15], "packag": [14, 15], "read": [14, 15], "spatial": 14, "transcriptom": 14, "slice": [14, 15], "anndata": [14, 15], "object": [14, 15], "comput": 14, "partial": 14, "pairwis": [14, 15], "us": 14, "project": 14, "all": 14, "onto": 14, "same": 14, "coordiant": 14, "system": 14, "accord": 14, "get": 15, "start": 15, "data": 15, "creat": 15, "run": 15, "sequenti": 15, "plot": 15, "center": 15, "gpu": 15, "implement": 15, "tutori": 16}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "nbsphinx": 4, "sphinx.ext.viewcode": 1, "sphinx": 57}, "alltitles": {"API": [[0, "api"]], "PASTE Alignment": [[0, "paste-alignment"]], "Visualization": [[0, "visualization"]], "Model Selection": [[0, "model-selection"]], "GLMPCA": [[0, "glmpca"]], "Miscellaneous": [[0, "miscellaneous"]], "paste3.glmpca.est_nb_theta": [[1, "paste3-glmpca-est-nb-theta"]], "paste3.glmpca.glmpca": [[2, "paste3-glmpca-glmpca"]], "paste3.glmpca.glmpca_init": [[3, "paste3-glmpca-glmpca-init"]], "paste3.glmpca.mat_binom_dev": [[4, "paste3-glmpca-mat-binom-dev"]], "paste3.glmpca.ortho": [[5, "paste3-glmpca-ortho"]], "paste3.helper.match_spots_using_spatial_heuristic": [[6, "paste3-helper-match-spots-using-spatial-heuristic"]], "paste3.model_selection.plot_edge_curve": [[7, "paste3-model-selection-plot-edge-curve"]], "paste3.paste.center_align": [[8, "paste3-paste-center-align"]], "paste3.paste.pairwise_align": [[9, "paste3-paste-pairwise-align"]], "paste3.visualization.plot_slice": [[10, "paste3-visualization-plot-slice"]], "paste3.visualization.stack_slices_center": [[11, "paste3-visualization-stack-slices-center"]], "paste3.visualization.stack_slices_pairwise": [[12, "paste3-visualization-stack-slices-pairwise"]], "Welcome to PASTE3 documentation!": [[13, "welcome-to-paste3-documentation"]], "Manuscript": [[13, "manuscript"]], "Contents:": [[13, null]], "Install PASTE2 python package": [[14, "Install-PASTE2-python-package"]], "Read in Spatial Transcriptomics slices as AnnData objects": [[14, "Read-in-Spatial-Transcriptomics-slices-as-AnnData-objects"]], "Compute partial pairwise alignment using PASTE2": [[14, "Compute-partial-pairwise-alignment-using-PASTE2"]], "Project all slices onto the same coordiante system according to the alignment": [[14, "Project-all-slices-onto-the-same-coordiante-system-according-to-the-alignment"]], "Getting Started": [[15, "Getting-Started"]], "Install paste python package": [[15, "Install-paste-python-package"]], "Read data and create AnnData object": [[15, "Read-data-and-create-AnnData-object"]], "Pairwise Alignment": [[15, "Pairwise-Alignment"]], "Run PASTE pairwise_align.": [[15, "Run-PASTE-pairwise_align."]], "Sequential pairwise slice alignment plots": [[15, "Sequential-pairwise-slice-alignment-plots"]], "Center Alignment": [[15, "Center-Alignment"]], "Run PASTE center_align.": [[15, "Run-PASTE-center_align."]], "Center slice alignment plots": [[15, "Center-slice-alignment-plots"]], "Gpu Implementation": [[15, "Gpu-Implementation"]], "Running PASTE with gpu": [[15, "Running-PASTE-with-gpu"]], "Tutorials": [[16, "tutorials"]]}, "indexentries": {"module": [[0, "module-paste3"]], "paste3": [[0, "module-paste3"]], "est_nb_theta() (in module paste3.glmpca)": [[1, "paste3.glmpca.est_nb_theta"]], "glmpca() (in module paste3.glmpca)": [[2, "paste3.glmpca.glmpca"]], "glmpca_init() (in module paste3.glmpca)": [[3, "paste3.glmpca.glmpca_init"]], "mat_binom_dev() (in module paste3.glmpca)": [[4, "paste3.glmpca.mat_binom_dev"]], "ortho() (in module paste3.glmpca)": [[5, "paste3.glmpca.ortho"]], "match_spots_using_spatial_heuristic() (in module paste3.helper)": [[6, "paste3.helper.match_spots_using_spatial_heuristic"]], "plot_edge_curve() (in module paste3.model_selection)": [[7, "paste3.model_selection.plot_edge_curve"]], "center_align() (in module paste3.paste)": [[8, "paste3.paste.center_align"]], "pairwise_align() (in module paste3.paste)": [[9, "paste3.paste.pairwise_align"]], "plot_slice() (in module paste3.visualization)": [[10, "paste3.visualization.plot_slice"]], "stack_slices_center() (in module paste3.visualization)": [[11, "paste3.visualization.stack_slices_center"]], "stack_slices_pairwise() (in module paste3.visualization)": [[12, "paste3.visualization.stack_slices_pairwise"]]}})