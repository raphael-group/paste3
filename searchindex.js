Search.setIndex({"docnames": ["api", "api/paste3.glmpca.est_nb_theta", "api/paste3.glmpca.glmpca", "api/paste3.glmpca.glmpca_init", "api/paste3.glmpca.mat_binom_dev", "api/paste3.glmpca.ortho", "api/paste3.helper.match_spots_using_spatial_heuristic", "api/paste3.model_selection.calculate_convex_hull_edge_inconsistency", "api/paste3.model_selection.create_graph", "api/paste3.model_selection.edge_inconsistency_score", "api/paste3.model_selection.generate_graph_from_labels", "api/paste3.model_selection.plot_edge_curve", "api/paste3.paste.center_align", "api/paste3.paste.pairwise_align", "api/paste3.visualization.plot_slice", "api/paste3.visualization.stack_slices_center", "api/paste3.visualization.stack_slices_pairwise", "index", "notebooks/paste2_tutorial", "notebooks/paste_tutorial", "tutorial"], "filenames": ["api.rst", "api/paste3.glmpca.est_nb_theta.rst", "api/paste3.glmpca.glmpca.rst", "api/paste3.glmpca.glmpca_init.rst", "api/paste3.glmpca.mat_binom_dev.rst", "api/paste3.glmpca.ortho.rst", "api/paste3.helper.match_spots_using_spatial_heuristic.rst", "api/paste3.model_selection.calculate_convex_hull_edge_inconsistency.rst", "api/paste3.model_selection.create_graph.rst", "api/paste3.model_selection.edge_inconsistency_score.rst", "api/paste3.model_selection.generate_graph_from_labels.rst", "api/paste3.model_selection.plot_edge_curve.rst", "api/paste3.paste.center_align.rst", "api/paste3.paste.pairwise_align.rst", "api/paste3.visualization.plot_slice.rst", "api/paste3.visualization.stack_slices_center.rst", "api/paste3.visualization.stack_slices_pairwise.rst", "index.rst", "notebooks/paste2_tutorial.ipynb", "notebooks/paste_tutorial.ipynb", "tutorial.rst"], "titles": ["API", "paste3.glmpca.est_nb_theta", "paste3.glmpca.glmpca", "paste3.glmpca.glmpca_init", "paste3.glmpca.mat_binom_dev", "paste3.glmpca.ortho", "paste3.helper.match_spots_using_spatial_heuristic", "paste3.model_selection.calculate_convex_hull_edge_inconsistency", "paste3.model_selection.create_graph", "paste3.model_selection.edge_inconsistency_score", "paste3.model_selection.generate_graph_from_labels", "paste3.model_selection.plot_edge_curve", "paste3.paste.center_align", "paste3.paste.pairwise_align", "paste3.visualization.plot_slice", "paste3.visualization.stack_slices_center", "paste3.visualization.stack_slices_pairwise", "Welcome to PASTE3 documentation!", "Install PASTE2 python package", "Getting Started", "Tutorials"], "terms": {"import": [0, 2, 18, 19], "paste3": [0, 18, 19], "y": [1, 2, 3, 5, 19], "mu": [1, 2], "th": [1, 12], "sourc": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16], "given": [1, 12, 13, 17], "count": [1, 2, 12], "data": [1, 2, 3, 5, 12, 13, 17, 18, 20], "predict": 1, "mean": 1, "0": [1, 2, 5, 12, 13, 15, 16, 18, 19], "neg": [1, 2], "binom": 1, "theta": [1, 13, 15, 16], "us": [1, 2, 6, 8, 12, 13, 17, 19, 20], "newton": 1, "": [1, 2, 12, 13, 14, 18, 19, 20], "method": [1, 2, 12, 17], "updat": [1, 12, 19], "base": [1, 2, 6, 13], "binomi": [1, 2, 4], "likelihood": [1, 2, 3], "note": [1, 2, 19], "thi": [1, 2, 12, 13, 16, 18, 19], "observ": [1, 2], "rather": 1, "than": [1, 19], "expect": 1, "inform": [1, 12, 13, 18], "regular": [1, 12, 13], "let": [1, 18], "u": [1, 2, 5, 19], "log": 1, "we": [1, 2, 13, 18, 19], "prior": 1, "n": [1, 4, 12, 13, 18], "1": [1, 2, 5, 8, 12, 13, 15, 16, 18, 19], "penalti": [1, 2], "equival": [1, 2], "assum": [1, 5, 19], "lognorm": 1, "so": [1, 2, 18], "mode": 1, "i": [1, 2, 3, 4, 5, 12, 13, 15, 16, 17, 18, 19], "geometr": 1, "distr": 1, "dtheta": 1, "du": 1, "e": [1, 2, 5], "d2theta": 1, "du2": 1, "dl": 1, "l": [2, 12, 13, 19], "fam": [2, 3], "poi": [2, 3], "ctl": 2, "none": [2, 3, 5, 12, 13, 14, 18], "init": 2, "nb_theta": [2, 3], "100": [2, 14, 18, 19], "x": [2, 3, 4, 5, 12, 13, 18, 19], "z": [2, 5, 17, 18, 19], "sz": [2, 3], "glm": 2, "pca": [2, 13], "function": [2, 12, 13, 17, 18, 19], "implement": [2, 18], "dimension": [2, 12, 19], "reduct": 2, "high": 2, "The": [2, 12, 13, 18], "basic": 2, "model": [2, 13, 17], "r": [2, 5, 12, 13], "ax": [2, 5, 14, 19], "zg": [2, 5], "vu": [2, 5], "where": [2, 5, 12, 13, 18], "m": [2, 12], "linkinv": 2, "regress": [2, 3], "coeffici": [2, 3, 5], "ar": [2, 4, 12, 13, 18, 19], "A": [2, 3, 5, 6, 12], "g": [2, 5, 8, 9, 12, 13, 18], "latent": 2, "factor": [2, 3, 5], "load": [2, 5], "v": [2, 5, 19], "object": [2, 3, 12, 13, 17], "being": 2, "optim": [2, 6, 12, 13], "devianc": [2, 4], "between": [2, 6, 12, 13, 15, 16, 17, 18, 19], "plu": 2, "an": [2, 12, 13, 15, 18, 19], "l2": [2, 18], "ridg": 2, "random": [2, 12], "initi": [2, 3, 12, 13, 19], "fulli": [2, 17], "reproduc": [2, 12, 18], "result": 2, "one": [2, 13, 16, 17], "should": [2, 18, 20], "set": [2, 12, 13, 18, 19], "seed": [2, 12], "type": [2, 6, 12, 13, 14, 15, 16], "param": [2, 8], "column": [2, 12, 18, 19], "array_lik": 2, "featur": 2, "row": [2, 12, 18, 19], "desir": 2, "number": [2, 8, 12, 13, 19], "dimens": [2, 5], "integ": 2, "string": 2, "describ": [2, 13], "possibl": 2, "valu": [2, 13, 17, 19], "includ": [2, 12, 18, 19], "poisson": 2, "nb": [2, 3], "mult": 2, "approxim": [2, 12], "multinomi": 2, "bern": 2, "bernoulli": 2, "option": [2, 3, 6, 12, 13, 14, 15, 16, 18, 19], "dict": [2, 18], "dictionari": [2, 8, 10], "control": 2, "paramet": [2, 6, 12, 13, 14, 15, 16, 18, 19], "valid": [2, 18], "kei": 2, "maxit": [2, 13, 18], "maximum": [2, 12, 13, 18, 19], "iter": [2, 12, 13, 18, 19], "ep": [2, 13], "float": [2, 12, 13, 14, 15, 16], "rel": 2, "chang": [2, 12], "toler": [2, 13], "converg": [2, 12, 13, 19], "optimizetheta": [2, 13], "distribut": [2, 12, 13], "default": [2, 3, 12, 13, 19], "fix": 2, "provid": [2, 13, 17, 18, 19], "bool": [2, 6, 12, 13, 16], "indic": [2, 18], "overdispers": 2, "penal": 2, "matric": [2, 13], "contain": [2, 12, 13], "estim": 2, "goe": 2, "infin": 2, "alpha": [2, 12, 13, 18], "statsmodel": 2, "packag": [2, 17], "If": [2, 6, 12, 13, 15, 16], "true": [2, 6, 12, 13, 15, 16, 18, 19], "covari": [2, 5], "ani": [2, 12, 14], "all": [2, 12, 17, 19], "same": [2, 4, 12, 13, 17, 19], "eg": 2, "intercept": 2, "remov": [2, 18], "becaus": 2, "forc": 2, "want": [2, 19], "avoid": 2, "collinear": 2, "usual": 2, "need": [2, 18], "numer": 2, "vector": [2, 3, 4], "size": [2, 3, 14, 18], "place": 2, "total": [2, 16], "return": [2, 6, 8, 10, 12, 13, 14, 15, 16, 18, 19], "follow": [2, 12, 13, 18], "element": [2, 18], "arrai": [2, 3, 4, 5, 18, 19], "whose": 2, "match": [2, 6], "It": 2, "analog": 2, "princip": [2, 13], "compon": [2, 12, 13], "each": [2, 12, 13, 15, 16, 17, 18, 19], "differ": [2, 12, 13, 19], "coefx": 2, "specif": [2, 5, 18], "correspond": 2, "first": [2, 6, 13, 18, 19], "which": [2, 18], "coefz": 2, "By": 2, "dev": 2, "length": [2, 4], "took": 2, "gener": [2, 13], "decreas": 2, "over": [2, 12, 13], "time": [2, 12, 13, 18, 19], "fluctuat": 2, "wildli": 2, "often": 2, "instabl": 2, "can": [2, 17, 18, 19], "improv": [2, 19], "increas": [2, 19], "glmpca_famili": [2, 3], "class": 2, "glmpcafamili": 2, "minor": 2, "wrapper": 2, "famili": 2, "fit": 2, "standard": 2, "variou": 2, "intern": [2, 14], "For": [2, 18, 19], "case": [2, 18, 19], "also": [2, 15, 19], "final": 2, "dispers": 2, "exampl": [2, 18, 20], "creat": [2, 3, 10], "simpl": 2, "dataset": [2, 6, 18, 19], "two": [2, 4, 6, 12, 13, 17, 18, 19], "cluster": 2, "visual": [2, 17, 18, 19], "structur": 2, "from": [2, 12, 13, 18, 19], "numpi": [2, 18, 19], "exp": 2, "repeat": 2, "matplotlib": [2, 14, 18, 19], "pyplot": [2, 14, 18, 19], "scatter": [2, 18], "randn": 2, "20": [2, 18, 19], "rang": [2, 18, 19], "10": [2, 12, 18, 19], "clust": 2, "red": 2, "black": 2, "re": [2, 18], "t": [2, 12, 13, 19], "2": [2, 12, 13, 15, 16, 18, 19], "c": [2, 12, 13, 18], "refer": [2, 12], "town": 2, "fw": 2, "hick": 2, "sc": [2, 18, 19], "arye": 2, "mj": 2, "irizarri": 2, "ra": 2, "select": [2, 13, 17], "singl": 2, "cell": [2, 5], "rna": 2, "seq": 2, "biorxiv": [2, 17], "2019": 2, "http": [2, 18, 19], "www": 2, "org": [2, 18, 19], "content": 2, "1101": 2, "574574v1": 2, "analysi": [2, 13, 16, 20], "arxiv": 2, "ab": 2, "1907": 2, "02647": 2, "jxn": [3, 4, 5], "colmean": 3, "colsum": 3, "ignor": [3, 18], "unless": 3, "p": [4, 12, 13], "col": 4, "nxl": 5, "jxl": 5, "onto": [5, 17], "gene": [5, 12, 13, 17, 18, 19], "nxko": 5, "jxko": 5, "jxkf": 5, "nxkf": 5, "imput": 5, "express": [5, 12, 13, 17, 18, 19], "a_spatial_dist": 6, "b_spatial_dist": 6, "use_ot": 6, "spatial": [6, 8, 12, 13, 14, 15, 16, 17, 19], "coordin": [6, 8, 12, 13, 14, 15, 16, 17, 18, 19], "either": 6, "transport": [6, 12, 13], "bipartit": 6, "proxim": 6, "np": [6, 12, 13, 18, 19], "ndarrai": [6, 12, 13, 15, 16], "spot": [6, 8, 12, 13, 14, 17, 18, 19], "distanc": [6, 12, 13, 17, 19], "matrix": [6, 12, 13, 15, 17, 18, 19], "slice": [6, 8, 12, 13, 14, 15, 16, 17], "second": [6, 13], "ot": [6, 19], "fals": [6, 12, 13, 16, 18, 19], "minimum": 6, "weight": [6, 12, 13], "full": [6, 12, 13], "pi": [6, 7, 12, 13, 15, 16, 18, 19], "repres": [6, 12, 13], "point": 6, "slicea": [7, 18], "sliceb": [7, 18], "adata": [8, 10, 18], "degre": 8, "4": [8, 13, 18, 19], "convert": 8, "graph": [8, 10], "networkx": 8, "librari": [8, 12], "st": [8, 18], "edg": 8, "per": 8, "vertex": 8, "node_dict": 8, "map": [8, 12, 13, 18, 19], "node": [8, 10], "label": [9, 18, 19], "labels_dict": 10, "cluster_label": 10, "m_list": 11, "source_list": 11, "target_list": 11, "initial_slic": [12, 19], "slice_weight": 12, "n_compon": 12, "15": [12, 18, 19], "threshold": 12, "001": 12, "max_it": 12, "exp_dissim_metr": [12, 13], "kl": [12, 13], "norm": [12, 13, 18], "random_se": [12, 19], "pi_init": [12, 13, 19], "spots_weight": 12, "use_gpu": [12, 13, 19], "fast": 12, "pbar": 12, "infer": [12, 15, 19], "center": [12, 15, 17], "consist": [12, 18, 19], "low": [12, 19], "rank": 12, "wh": 12, "collect": 12, "input": [12, 18, 19], "d": [12, 13, 19], "dot": 12, "n_1": 12, "n_t": 12, "respect": [12, 13], "mathbb": [12, 13], "_": [12, 13, 18, 19], "cost": [12, 13], "lambda": 12, "t_": 12, "leq": [12, 13], "find": [12, 13, 17, 18], "w": 12, "h": 12, "q": 12, "gamma": [12, 13], "minim": [12, 13], "sum_q": 12, "lambda_q": 12, "f": [12, 13, 18], "left": [12, 13], "sum_": [12, 13], "j": [12, 13], "wh_": 12, "cdot": 12, "_j": [12, 13], "ij": [12, 13], "k": [12, 13, 18], "d_": [12, 13], "ik": [12, 13], "jl": [12, 13], "right": [12, 13], "x_": 12, "transcript": [12, 13], "d_ij": 12, "parallel": 12, "z_": 12, "pairwis": [12, 13, 16, 17], "measur": 12, "nonneg": 12, "profil": 12, "balanc": [12, 13], "preserv": [12, 13], "form": [12, 18], "weigh": 12, "anndata": [12, 13, 14, 15, 16, 17], "align": [12, 13, 15, 16, 17], "list": [12, 15, 16, 18], "process": [12, 13], "treat": 12, "equal": 12, "dissimilar": [12, 13], "among": [12, 13], "onli": [12, 13, 18], "while": [12, 13], "int": [12, 13], "nmf": [12, 19], "stop": 12, "when": [12, 13, 17], "loss": 12, "below": [12, 18, 19], "str": [12, 13, 18, 19], "metric": [12, 13], "comput": [12, 13, 17, 19], "euclidean": [12, 13], "kullback": [12, 13], "leibler": [12, 13], "diverg": [12, 13], "normal": [12, 13], "plan": [12, 13, 18], "individu": 12, "uniform": [12, 13], "whether": [12, 13, 16], "gpu": [12, 13, 18], "avail": [12, 13, 18, 19], "cpu": [12, 13, 18, 19], "untest": 12, "torch": [12, 18, 19], "progress": 12, "bar": 12, "tqdm": 12, "deriv": 12, "track": 12, "someth": 12, "ha": [12, 13], "tupl": [12, 13, 15, 16], "center_slic": [12, 15, 19], "after": [12, 18], "represent": [12, 19], "feature_matrix": 12, "coeff_matrix": 12, "a_slic": 13, "b_slice": 13, "overlap_fract": [13, 18], "exp_dissim_matrix": 13, "a_spots_weight": 13, "b_spots_weight": 13, "numitermax": 13, "200": [13, 19], "1000": [13, 18], "0001": 13, "do_histologi": 13, "pi_": 13, "anoth": 13, "probabl": 13, "x_i": 13, "tag": 13, "subject": [13, 18], "constraint": 13, "probabilist": 13, "coupl": 13, "mathcal": 13, "mid": 13, "geq": 13, "1_": 13, "1_n": 13, "appli": 13, "textit": 13, "solv": [13, 19], "partial": [13, 16, 17], "problem": [13, 19], "equat": 13, "allow": [13, 18, 19], "unmap": 13, "fraction": 13, "mass": 13, "defin": 13, "3": [13, 18, 19], "overlap": [13, 17, 18], "percentag": [13, 17, 18], "ensur": 13, "must": 13, "perform": 13, "precomput": 13, "euc": 13, "gkl": 13, "selection_kl": 13, "approach": 13, "glmpca": [13, 17], "linear": 13, "calcul": [13, 19], "dure": 13, "1e": 13, "level": 13, "incorpor": 13, "rgb": 13, "histologi": 13, "info": [13, 18, 19], "return_obj": 13, "els": 13, "color": [14, 18, 19], "plot": [14, 18], "scatterplot": 14, "format": 14, "accept": 14, "pre": 14, "exist": 14, "otherwis": 14, "call": [14, 18], "gca": [14, 18, 19], "In": [15, 16, 17, 18, 19], "other": [15, 16, 18], "word": [15, 16], "origin": [15, 18, 19], "center_align": 15, "output": [15, 16, 19], "output_param": [15, 16], "addition": [15, 16], "angl": [15, 16], "rotat": [15, 16], "translat": [15, 16], "instead": 15, "x_translat": [15, 16], "y_translat": [15, 16], "is_parti": [16, 18], "sequenti": 16, "pairwise_align": [16, 18], "consecut": [16, 17, 18], "return_param": 16, "addtion": 16, "boolean": 16, "wip": 17, "combin": 17, "past": [17, 18, 20], "paste2": [17, 20], "leverag": 17, "both": [17, 19], "similar": 17, "integr": 17, "transcriptom": 17, "extens": 17, "3d": [17, 18], "reconstruct": [17, 18], "thei": [17, 19], "do": [17, 19], "space": 17, "particular": [17, 19], "five": 17, "main": 17, "across": 17, "multipl": 17, "pair": [17, 18], "decid": 17, "5": [17, 18, 19], "stack": 17, "sequenc": [17, 18], "them": [17, 19], "project": [17, 19], "2d": [17, 18], "system": [17, 19], "done": [17, 18, 19], "assign": 17, "you": [17, 18, 19], "view": 17, "preprint": 17, "api": 17, "miscellan": 17, "tutori": [17, 18], "get": 17, "start": 17, "instal": 17, "python": 17, "read": 17, "coordiant": 17, "accord": 17, "patch": [18, 19], "mpatch": [18, 19], "plt": [18, 19], "scanpi": [18, 19], "seaborn": 18, "sn": 18, "squidpi": 18, "sq": 18, "opt": [18, 19], "hostedtoolcach": [18, 19], "12": [18, 19], "7": [18, 19], "x64": [18, 19], "lib": [18, 19], "python3": [18, 19], "site": [18, 19], "dask": 18, "datafram": [18, 19], "__init__": 18, "py": [18, 19], "31": [18, 19], "futurewarn": 18, "legaci": 18, "deprec": 18, "futur": 18, "version": 18, "configur": 18, "queri": 18, "enabl": 18, "new": 18, "silenc": 18, "warn": 18, "numba": 18, "core": 18, "decor": 18, "246": [18, 19], "runtimewarn": 18, "nopython": 18, "njit": 18, "39": 18, "pypi": [18, 19], "four": 18, "dlpfc": 18, "patient": 18, "crop": 18, "subslic": 18, "see": [18, 19], "figur": [18, 19], "3a": 18, "our": [18, 19], "paper": 18, "store": 18, "slicea_filenam": 18, "test": [18, 19], "151673": 18, "h5ad": 18, "sliceb_filenam": 18, "151674": 18, "slicec_filenam": 18, "151675": 18, "sliced_filenam": 18, "151676": 18, "read_h5ad": 18, "slicec": 18, "matrx": [18, 19], "field": 18, "obsm": [18, 19], "lt": [18, 19], "compress": 18, "spars": 18, "dtype": [18, 19], "float32": [18, 19], "5798687": 18, "shape": 18, "2929": 18, "11381": 18, "gt": [18, 19], "5769": 18, "2807": 18, "4068": 18, "9505": 18, "3393": 18, "7583": 18, "4631": 18, "7831": 18, "5571": 18, "11193": 18, "6317": 18, "3291": 18, "6": [18, 19], "ob": [18, 19], "in_tissu": 18, "array_row": 18, "array_col": 18, "imagerow": 18, "imagecol": 18, "sum_umi": 18, "sum_gen": 18, "posit": 18, "replic": 18, "layer_guess_reordered_short": 18, "n_genes_by_count": 18, "log1p_n_genes_by_count": 18, "total_count": 18, "log1p_total_count": 18, "pct_counts_in_top_50_gen": 18, "pct_counts_in_top_100_gen": 18, "pct_counts_in_top_200_gen": 18, "pct_counts_in_top_500_gen": 18, "n_count": [18, 19], "aaacaatctactagca": 18, "43": 18, "126": 18, "327637": 18, "259": 18, "630972": 18, "1667": 18, "1150": 18, "br8100": 18, "l1": 18, "048386": 18, "419381": 18, "22": [18, 19], "975405": 18, "30": [18, 19], "173965": 18, "42": 18, "171566": 18, "61": 18, "007798": 18, "1628": 18, "aaacaccaataactgc": 18, "8": [18, 19], "59": 18, "19": [18, 19], "427": 18, "767792": 18, "183": 18, "078314": 18, "3769": 18, "1960": 18, "wm": 18, "581210": 18, "234830": 18, "25": [18, 19], "975060": 18, "33": 18, "138764": 18, "531175": 18, "697533": 18, "3704": 18, "aaacagctttcagaag": 18, "9": [18, 19], "341": 18, "269139": 18, "152": 18, "700275": 18, "4278": 18, "2264": 18, "l5": 18, "725330": 18, "361475": 18, "23": [18, 19], "796166": 18, "201029": 18, "38": [18, 19], "826554": 18, "54": 18, "698457": 18, "4217": 18, "aaacagggtctatatt": 18, "47": 18, "13": [18, 19], "362": 18, "916304": 18, "164": 18, "941500": 18, "4004": 18, "2178": 18, "l6": 18, "686621": 18, "295299": 18, "24": [18, 19], "600400": 18, "669331": 18, "185814": 18, "55": [18, 19], "344655": 18, "3922": 18, "aaacagtgttcctggg": 18, "73": 18, "503": 18, "780395": 18, "256": 18, "930702": 18, "2376": 18, "1432": 18, "267525": 18, "773594": 18, "26": [18, 19], "136364": 18, "501684": 18, "308081": 18, "60": 18, "774411": 18, "2339": 18, "ttgtttcacatccagg": 18, "58": [18, 19], "422": 18, "862301": 18, "254": [18, 19], "410450": 18, "4324": 18, "2170": 18, "682943": 18, "372168": 18, "941721": 18, "388529": 18, "40": 18, "703053": 18, "57": [18, 19], "770583": 18, "4266": 18, "ttgtttcattagtcta": 18, "433": 18, "393354": 18, "217": 18, "146722": 18, "2761": 18, "1560": 18, "353082": 18, "923710": 18, "439696": 18, "34": 18, "190511": 18, "824701": 18, "608113": 18, "2715": 18, "ttgtttccatacaact": 18, "45": 18, "27": [18, 19], "352": 18, "430255": 18, "208": 18, "415849": 18, "2322": 18, "1343": 18, "203406": 18, "750615": 18, "093885": 18, "37": [18, 19], "941430": 18, "243755": 18, "63": 18, "695090": 18, "2300": 18, "ttgtttgtattacacg": 18, "41": 18, "735391": 18, "250": [18, 19], "720081": 18, "2331": 18, "1420": 18, "259116": 18, "754481": 18, "139425": 18, "32": [18, 19], "947233": 18, "728443": 18, "531961": 18, "2286": 18, "ttgtttgtgtaaattc": 18, "51": 18, "148": 18, "109816": 18, "284": 18, "293439": 18, "6281": 18, "2927": 18, "982075": 18, "745443": 18, "231810": 18, "154434": 18, "242318": 18, "53": 18, "017036": 18, "6184": 18, "var": [18, 19], "gene_id": 18, "feature_typ": 18, "genom": 18, "n_cells_by_count": 18, "mean_count": 18, "log1p_mean_count": 18, "pct_dropout_by_count": 18, "noc2l": 18, "ensg00000188976": 18, "grch38": 18, "690": 18, "223963": 18, "202094": 18, "81": 18, "038747": 18, "815": 18, "704414": 18, "klhl17": 18, "ensg00000187961": 18, "163": 18, "045342": 18, "044344": 18, "95": 18, "520747": 18, "165": 18, "111988": 18, "hes4": 18, "ensg00000188290": 18, "875": 18, "303105": 18, "264750": 18, "75": 18, "954933": 18, "1103": 18, "006695": 18, "isg15": 18, "ensg00000187608": 18, "968": 18, "318494": 18, "276490": 18, "399286": 18, "1159": 18, "056175": 18, "agrn": 18, "ensg00000188157": 18, "1038": 18, "351470": 18, "301193": 18, "71": 18, "475680": 18, "1279": 18, "154615": 18, "mt": 18, "nd4": 18, "ensg00000198886": 18, "3639": 18, "85": 18, "596596": 18, "461260": 18, "000000": [18, 19], "311486": 18, "649113": 18, "nd5": 18, "ensg00000198786": 18, "3593": 18, "799670": 18, "379516": 18, "264084": 18, "35661": 18, "481841": 18, "nd6": 18, "ensg00000198695": 18, "1966": 18, "860126": 18, "620644": 18, "974169": 18, "3130": 18, "049108": 18, "cyb": 18, "ensg00000198727": 18, "49": [18, 19], "170376": 18, "915425": 18, "178931": 18, "094761": 18, "ac007325": 18, "ensg00000278817": 18, "577": 18, "183567": 18, "168533": 18, "84": 18, "143996": 18, "668": 18, "505784": 18, "layer_guess_reord": 18, "layer": [18, 19], "annot": 18, "pl": [18, 19], "spatial_scatt": 18, "frameon": 18, "figsiz": [18, 19], "pleas": 18, "specifi": 18, "library_id": 18, "perman": 18, "un": [18, 19], "_spatial_util": 18, "976": 18, "userwarn": 18, "No": 18, "colormap": 18, "via": 18, "cmap": 18, "_cax": 18, "give": 18, "partial_pairwise_align": 18, "To": 18, "well": 18, "70": 18, "area": 18, "your": [18, 19, 20], "own": 18, "manual": 18, "determin": 18, "approxiamt": 18, "doe": [18, 19], "have": [18, 19], "veri": 18, "accur": 18, "now": [18, 19], "here": 18, "demo": 18, "run": 18, "reson": 18, "amount": 18, "real": 18, "scenario": 18, "argument": 18, "pi_ab": 18, "16": [18, 19], "nov": [18, 19], "17": [18, 19], "52": [18, 19], "resort": [18, 19], "pi_bc": 18, "02": [18, 19], "11": [18, 19], "pi_cd": 18, "check": [18, 19], "n1": 18, "n2": 18, "print": [18, 19], "2877": 18, "2873": 18, "2701": 18, "There": 18, "checkout": 18, "signatur": 18, "souc": 18, "code": [18, 19], "document": 18, "def": [18, 19], "largest_indic": 18, "ari": 18, "largest": 18, "flat": 18, "flatten": 18, "argpartit": 18, "argsort": 18, "unravel_index": 18, "plot2d_samples_mat": 18, "xt": 18, "top": 18, "weight_alpha": 18, "kwarg": 18, "mx": 18, "max": 18, "item": 18, "idx": 18, "thr": 18, "len": [18, 19], "plot_slice_pairwise_align": 18, "slice1": [18, 19], "slice2": [18, 19], "05": [18, 19], "coordinates1": 18, "coordinates2": 18, "offset": 18, "min": 18, "temp": 18, "zero": 18, "linewidth": 18, "marker": 18, "zip": 18, "cat": 18, "categori": 18, "layer_guess_reordered_color": 18, "strict": 18, "invert_yaxi": [18, 19], "axi": [18, 19], "off": [18, 19], "show": [18, 19], "onc": 18, "adjac": 18, "assig": 18, "partial_stack_slices_pairwis": 18, "14": [18, 19], "new_slic": [18, 19], "stack_slices_pairwis": [18, 19], "layer_to_color_map": 18, "color_palett": 18, "plot_slices_overlap": 18, "astyp": 18, "legend": [18, 19], "handl": [18, 19], "fontsiz": 18, "titl": 18, "cortex": 18, "title_fonts": 18, "bbox_to_anchor": 18, "Or": 18, "just": 18, "3c": 18, "bio": 19, "panda": 19, "pd": 19, "helper": 19, "get_common_gen": 19, "match_spots_using_spatial_heurist": 19, "plot_slic": 19, "stack_slices_cent": 19, "data_dir": 19, "name": 19, "slice_nam": 19, "_coor": 19, "csv": 19, "load_slic": 19, "slice_i": 19, "read_csv": 19, "slice_i_coor": 19, "genfromtxt": 19, "delimit": 19, "preprocess": 19, "pp": 19, "filter_gen": 19, "min_count": 19, "filter_cel": 19, "append": 19, "slice3": 19, "slice4": 19, "064": 19, "086": 19, "116": 19, "015": 19, "945": 19, "999": 19, "987": 19, "011": 19, "984": 19, "choos": 19, "howev": 19, "064x6": 19, "2181": 19, "116x7": 19, "2295": 19, "945x6": 19, "3375": 19, "987x7": 19, "2935": 19, "011x7": 19, "2964": 19, "21": 19, "953x24": 19, "847": 19, "541": 19, "98x24": 19, "963": 19, "860": 19, "063x24": 19, "964": 19, "508": 19, "007x25": 19, "045": 19, "626": 19, "957x25": 19, "871": 19, "2515": 19, "gapdh": 19, "2233": 19, "ube2g2": 19, "78": 19, "mapkapk2": 19, "255": 19, "ndufa7": 19, "96": 19, "asna1": 19, "172": 19, "dip2c": 19, "lypla2": 19, "rgp1": 19, "bpgm": 19, "hps6": 19, "7998": 19, "slice_color": 19, "e41a1c": 19, "377eb8": 19, "4daf4a": 19, "984ea3": 19, "fig": 19, "subplot": 19, "spot_siz": 19, "pi12": 19, "pi23": 19, "pi34": 19, "runtim": 19, "3858058452606201": 19, "240": 19, "241": 19, "242": 19, "243": 19, "244": 19, "245": 19, "247": 19, "248": 19, "249": 19, "003937": 19, "000000e": 19, "00": 19, "000063": 19, "003874": 19, "000126": 19, "003811": 19, "937008e": 19, "03": 19, "299213e": 19, "251": 19, "035766e": 19, "252": 19, "003748": 19, "000189": 19, "253": 19, "ve": 19, "400": 19, "togeth": 19, "delax": 19, "plotli": 19, "px": 19, "io": 19, "pio": 19, "render": 19, "notebook": [19, 20], "slices_color": 19, "scale": 19, "z_scale": 19, "enumer": 19, "df": 19, "scatter_3d": 19, "color_discrete_sequ": 19, "update_layout": 19, "scene_aspectmod": 19, "ran": 19, "abov": 19, "alter": 19, "copi": 19, "lmbda": 19, "algorithm": 19, "b": 19, "tensor": 19, "doubl": 19, "18": 19, "sklearn": 19, "decomposit": 19, "_nmf": 19, "1759": 19, "convergencewarn": 19, "reach": 19, "center_ot": 19, "865903767431423": 19, "3829621916807069": 19, "24886595911213": 19, "01": 19, "3880932065404366": 19, "005131014859729666": 19, "04": 19, "3915232061917202": 19, "003429999651283655": 19, "07": 19, "3930712361281365": 19, "0015480299364163397": 19, "395250483498415": 19, "0021792473702784143": 19, "3953790526176948": 19, "00012856911927983106": 19, "361464977264404": 19, "again": 19, "without": 19, "intial": 19, "paste_w": 19, "56406116e": 19, "17735608e": 19, "45992053e": 19, "67005408e": 19, "65816920e": 19, "64249334e": 19, "93240013e": 19, "38372966e": 19, "80787149e": 19, "61882753e": 19, "01921081e": 19, "46527714e": 19, "19665832e": 19, "88694801e": 19, "90303240e": 19, "75023311e": 19, "62389887e": 19, "17923350e": 19, "91596165e": 19, "19205072e": 19, "07181455e": 19, "61294426e": 19, "20524981e": 19, "33305738e": 19, "31159630e": 19, "82986839e": 19, "78688007e": 19, "82425693e": 19, "23265860e": 19, "58806995e": 19, "83314337e": 19, "68948804e": 19, "22536788e": 19, "16837119e": 19, "58040466e": 19, "97049918e": 19, "paste_h": 19, "00595555e": 19, "28095211e": 19, "99820106e": 19, "45672185e": 19, "42535682e": 19, "77099853e": 19, "84556880e": 19, "12907521e": 19, "19053463e": 19, "01912357e": 19, "03440813e": 19, "08299135e": 19, "93982105e": 19, "42403630e": 19, "30713051e": 19, "35120019e": 19, "50568645e": 19, "86018512e": 19, "05294205e": 19, "88580791e": 19, "20976581e": 19, "51081658e": 19, "00736543e": 19, "06": 19, "10129713e": 19, "20159500e": 19, "65184151e": 19, "04867309e": 19, "26153742e": 19, "25054026e": 19, "44712742e": 19, "73756503e": 19, "43537812e": 19, "13147999e": 19, "80617759e": 19, "99149863e": 19, "55629904e": 19, "next": 19, "center_color": 19, "orang": 19, "compar": 19, "sinc": 19, "remain": 19, "thu": 19, "cannot": 19, "pot": 19, "write": 19, "backend": 19, "agnost": 19, "pytorch": 19, "etc": 19, "pythonot": 19, "github": 19, "gen_modul": 19, "html": 19, "support": 19, "make": 19, "sure": 19, "One": 19, "wai": 19, "get_backend_list": 19, "numpybackend": 19, "0x7fec2e5a4fb0": 19, "torchbackend": 19, "0x7fec36e147d0": 19, "access": 19, "automat": 19, "still": 19, "help": 19, "know": 19, "debug": 19, "why": 19, "seem": 19, "cuda": 19, "is_avail": 19, "breast": 19, "small": 19, "mai": 19, "actual": 19, "faster": 19, "larger": 19, "greater": 19, "easi": 19, "28": 19, "36208081245422363": 19, "29": 19, "skip": 19, "previous": 19, "38540251265489": 19, "381581304723351": 19, "76698381737824": 19, "392083257538912": 19, "010501952815560989": 19, "3945581180803914": 19, "0024748605414794955": 19, "35": 19, "3955875667153284": 19, "0010294486349369247": 19, "3956006249691741": 19, "305825384578796e": 19, "791017055511475": 19, "These": 20, "serv": 20, "how": 20}, "objects": {"": [[0, 0, 0, "-", "paste3"]], "paste3.glmpca": [[1, 1, 1, "", "est_nb_theta"], [2, 1, 1, "", "glmpca"], [3, 1, 1, "", "glmpca_init"], [4, 1, 1, "", "mat_binom_dev"], [5, 1, 1, "", "ortho"]], "paste3.helper": [[6, 1, 1, "", "match_spots_using_spatial_heuristic"]], "paste3.model_selection": [[7, 1, 1, "", "calculate_convex_hull_edge_inconsistency"], [8, 1, 1, "", "create_graph"], [9, 1, 1, "", "edge_inconsistency_score"], [10, 1, 1, "", "generate_graph_from_labels"], [11, 1, 1, "", "plot_edge_curve"]], "paste3.paste": [[12, 1, 1, "", "center_align"], [13, 1, 1, "", "pairwise_align"]], "paste3.visualization": [[14, 1, 1, "", "plot_slice"], [15, 1, 1, "", "stack_slices_center"], [16, 1, 1, "", "stack_slices_pairwise"]]}, "objtypes": {"0": "py:module", "1": "py:function"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "function", "Python function"]}, "titleterms": {"api": 0, "past": [0, 12, 13, 19], "align": [0, 18, 19], "visual": [0, 14, 15, 16], "model": 0, "select": 0, "glmpca": [0, 1, 2, 3, 4, 5], "miscellan": 0, "paste3": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17], "est_nb_theta": 1, "glmpca_init": 3, "mat_binom_dev": 4, "ortho": 5, "helper": 6, "match_spots_using_spatial_heurist": 6, "model_select": [7, 8, 9, 10, 11], "calculate_convex_hull_edge_inconsist": 7, "create_graph": 8, "edge_inconsistency_scor": 9, "generate_graph_from_label": 10, "plot_edge_curv": 11, "center_align": [12, 19], "pairwise_align": [13, 19], "plot_slic": 14, "stack_slices_cent": 15, "stack_slices_pairwis": 16, "welcom": 17, "document": 17, "manuscript": 17, "content": 17, "instal": [18, 19], "paste2": 18, "python": [18, 19], "packag": [18, 19], "read": [18, 19], "spatial": 18, "transcriptom": 18, "slice": [18, 19], "anndata": [18, 19], "object": [18, 19], "comput": 18, "partial": 18, "pairwis": [18, 19], "us": 18, "project": 18, "all": 18, "onto": 18, "same": 18, "coordiant": 18, "system": 18, "accord": 18, "get": 19, "start": 19, "data": 19, "creat": 19, "run": 19, "sequenti": 19, "plot": 19, "center": 19, "gpu": 19, "implement": 19, "tutori": 20}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "nbsphinx": 4, "sphinx.ext.viewcode": 1, "sphinx": 57}, "alltitles": {"API": [[0, "api"]], "PASTE Alignment": [[0, "paste-alignment"]], "Visualization": [[0, "visualization"]], "Model Selection": [[0, "model-selection"]], "GLMPCA": [[0, "glmpca"]], "Miscellaneous": [[0, "miscellaneous"]], "paste3.glmpca.est_nb_theta": [[1, "paste3-glmpca-est-nb-theta"]], "paste3.glmpca.glmpca": [[2, "paste3-glmpca-glmpca"]], "paste3.glmpca.glmpca_init": [[3, "paste3-glmpca-glmpca-init"]], "paste3.glmpca.mat_binom_dev": [[4, "paste3-glmpca-mat-binom-dev"]], "paste3.glmpca.ortho": [[5, "paste3-glmpca-ortho"]], "paste3.helper.match_spots_using_spatial_heuristic": [[6, "paste3-helper-match-spots-using-spatial-heuristic"]], "paste3.model_selection.calculate_convex_hull_edge_inconsistency": [[7, "paste3-model-selection-calculate-convex-hull-edge-inconsistency"]], "paste3.model_selection.create_graph": [[8, "paste3-model-selection-create-graph"]], "paste3.model_selection.edge_inconsistency_score": [[9, "paste3-model-selection-edge-inconsistency-score"]], "paste3.model_selection.generate_graph_from_labels": [[10, "paste3-model-selection-generate-graph-from-labels"]], "paste3.model_selection.plot_edge_curve": [[11, "paste3-model-selection-plot-edge-curve"]], "paste3.paste.center_align": [[12, "paste3-paste-center-align"]], "paste3.paste.pairwise_align": [[13, "paste3-paste-pairwise-align"]], "paste3.visualization.plot_slice": [[14, "paste3-visualization-plot-slice"]], "paste3.visualization.stack_slices_center": [[15, "paste3-visualization-stack-slices-center"]], "paste3.visualization.stack_slices_pairwise": [[16, "paste3-visualization-stack-slices-pairwise"]], "Welcome to PASTE3 documentation!": [[17, "welcome-to-paste3-documentation"]], "Manuscript": [[17, "manuscript"]], "Contents:": [[17, null]], "Install PASTE2 python package": [[18, "Install-PASTE2-python-package"]], "Read in Spatial Transcriptomics slices as AnnData objects": [[18, "Read-in-Spatial-Transcriptomics-slices-as-AnnData-objects"]], "Compute partial pairwise alignment using PASTE2": [[18, "Compute-partial-pairwise-alignment-using-PASTE2"]], "Project all slices onto the same coordiante system according to the alignment": [[18, "Project-all-slices-onto-the-same-coordiante-system-according-to-the-alignment"]], "Getting Started": [[19, "Getting-Started"]], "Install paste python package": [[19, "Install-paste-python-package"]], "Read data and create AnnData object": [[19, "Read-data-and-create-AnnData-object"]], "Pairwise Alignment": [[19, "Pairwise-Alignment"]], "Run PASTE pairwise_align.": [[19, "Run-PASTE-pairwise_align."]], "Sequential pairwise slice alignment plots": [[19, "Sequential-pairwise-slice-alignment-plots"]], "Center Alignment": [[19, "Center-Alignment"]], "Run PASTE center_align.": [[19, "Run-PASTE-center_align."]], "Center slice alignment plots": [[19, "Center-slice-alignment-plots"]], "Gpu Implementation": [[19, "Gpu-Implementation"]], "Running PASTE with gpu": [[19, "Running-PASTE-with-gpu"]], "Tutorials": [[20, "tutorials"]]}, "indexentries": {"module": [[0, "module-paste3"]], "paste3": [[0, "module-paste3"]], "est_nb_theta() (in module paste3.glmpca)": [[1, "paste3.glmpca.est_nb_theta"]], "glmpca() (in module paste3.glmpca)": [[2, "paste3.glmpca.glmpca"]], "glmpca_init() (in module paste3.glmpca)": [[3, "paste3.glmpca.glmpca_init"]], "mat_binom_dev() (in module paste3.glmpca)": [[4, "paste3.glmpca.mat_binom_dev"]], "ortho() (in module paste3.glmpca)": [[5, "paste3.glmpca.ortho"]], "match_spots_using_spatial_heuristic() (in module paste3.helper)": [[6, "paste3.helper.match_spots_using_spatial_heuristic"]], "calculate_convex_hull_edge_inconsistency() (in module paste3.model_selection)": [[7, "paste3.model_selection.calculate_convex_hull_edge_inconsistency"]], "create_graph() (in module paste3.model_selection)": [[8, "paste3.model_selection.create_graph"]], "edge_inconsistency_score() (in module paste3.model_selection)": [[9, "paste3.model_selection.edge_inconsistency_score"]], "generate_graph_from_labels() (in module paste3.model_selection)": [[10, "paste3.model_selection.generate_graph_from_labels"]], "plot_edge_curve() (in module paste3.model_selection)": [[11, "paste3.model_selection.plot_edge_curve"]], "center_align() (in module paste3.paste)": [[12, "paste3.paste.center_align"]], "pairwise_align() (in module paste3.paste)": [[13, "paste3.paste.pairwise_align"]], "plot_slice() (in module paste3.visualization)": [[14, "paste3.visualization.plot_slice"]], "stack_slices_center() (in module paste3.visualization)": [[15, "paste3.visualization.stack_slices_center"]], "stack_slices_pairwise() (in module paste3.visualization)": [[16, "paste3.visualization.stack_slices_pairwise"]]}})